(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))t(n);new MutationObserver(n=>{for(const o of n)if(o.type==="childList")for(const s of o.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&t(s)}).observe(document,{childList:!0,subtree:!0});function i(n){const o={};return n.integrity&&(o.integrity=n.integrity),n.referrerPolicy&&(o.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?o.credentials="include":n.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function t(n){if(n.ep)return;n.ep=!0;const o=i(n);fetch(n.href,o)}})();class y{currentScene=null;canvas;ctx;lastTime=0;constructor(e){this.canvas=e;const i=e.getContext("2d");if(!i)throw new Error("Could not get 2D context");this.ctx=i,this.loop=this.loop.bind(this),requestAnimationFrame(this.loop),window.addEventListener("resize",()=>{this.resize()}),this.resize()}getCanvas(){return this.canvas}switchScene(e){console.log(`DEBUG: SwitchScene: ${e.constructor.name}`),this.currentScene&&this.currentScene.cleanup(),this.currentScene=e,this.currentScene.init(),this.currentScene.onResize(this.canvas.width,this.canvas.height)}resize(){this.canvas.width=window.innerWidth,this.canvas.height=window.innerHeight,this.currentScene&&this.currentScene.onResize(this.canvas.width,this.canvas.height)}loop(e){const i=e-this.lastTime;this.lastTime=e,this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.currentScene&&(this.currentScene.update(i),this.currentScene.draw(this.ctx)),requestAnimationFrame(this.loop)}}class u{static instance;currentSlot="sara";slots={};constructor(){this.slots={sara:this.createDefaultSlot("Sara"),lara:this.createDefaultSlot("Lara"),sofia:this.createDefaultSlot("Sofia")}}createDefaultSlot(e){return{playerName:e,character:{hairStyle:0,hairColor:"#ff9a9e",outfit:0,outfitColor:"#a18cd1",skinTone:"#f5d0b0",pet:null},highScores:{runner:0,tetris:0}}}static getInstance(){return u.instance||(u.instance=new u),u.instance}get playerName(){return this.slots[this.currentSlot].playerName}set playerName(e){this.slots[this.currentSlot].playerName=e,this.save()}get character(){return this.slots[this.currentSlot].character}set character(e){this.slots[this.currentSlot].character=e,this.save()}get highScores(){return this.slots[this.currentSlot].highScores}updateHighScore(e,i){const t=this.slots[this.currentSlot].highScores[e]||0;i>t&&(this.slots[this.currentSlot].highScores[e]=i,this.save())}save(){localStorage.setItem("sara-demon-hunters-save-v2",JSON.stringify(this.slots))}load(){const e=localStorage.getItem("sara-demon-hunters-save-v2");if(e)try{const i=JSON.parse(e);this.slots={...this.slots,...i}}catch(i){console.error("Failed to load save data",i)}}}class b{sceneManager;isDrawing=!1;points=[];paths=[];currentColor="#000000";currentWidth=5;colors=["#000000","#FF0000","#00FF00","#0000FF","#FFFF00","#FF00FF","#00FFFF","#FFFFFF"];buttons=[];constructor(e){this.sceneManager=e}init(){this.createUI(),window.addEventListener("mousedown",this.onMouseDown),window.addEventListener("mousemove",this.onMouseMove),window.addEventListener("mouseup",this.onMouseUp),window.addEventListener("touchstart",this.onTouchStart,{passive:!1}),window.addEventListener("touchmove",this.onTouchMove,{passive:!1}),window.addEventListener("touchend",this.onTouchEnd)}createUI(){this.buttons=[];let e=100;this.colors.forEach(i=>{this.buttons.push({color:i,x:20,y:e,width:40,height:40,action:()=>{this.currentColor=i,this.currentWidth=i==="#FFFFFF"?20:5}}),e+=50}),this.buttons.push({text:"Clear",x:20,y:e+20,width:60,height:40,action:()=>{this.paths=[]}}),this.buttons.push({text:"Back",x:window.innerWidth-100,y:20,width:80,height:40,action:()=>{this.sceneManager.switchScene(new c(this.sceneManager))}})}onMouseDown=e=>{this.checkUI(e.clientX,e.clientY)||(this.isDrawing=!0,this.points=[{x:e.clientX,y:e.clientY}])};onMouseMove=e=>{this.isDrawing&&this.points.push({x:e.clientX,y:e.clientY})};onMouseUp=e=>{this.isDrawing&&(this.isDrawing=!1,this.savePath())};onTouchStart=e=>{const i=e.touches[0];this.checkUI(i.clientX,i.clientY)||(e.preventDefault(),this.isDrawing=!0,this.points=[{x:i.clientX,y:i.clientY}])};onTouchMove=e=>{if(!this.isDrawing)return;e.preventDefault();const i=e.touches[0];this.points.push({x:i.clientX,y:i.clientY})};onTouchEnd=e=>{this.isDrawing&&(this.isDrawing=!1,this.savePath())};checkUI(e,i){for(const t of this.buttons)if(e>=t.x&&e<=t.x+t.width&&i>=t.y&&i<=t.y+t.height)return t.action(),!0;return!1}savePath(){this.points.length>0&&(this.paths.push({points:[...this.points],color:this.currentColor,width:this.currentWidth}),this.points=[])}update(e){}draw(e){if(e.fillStyle="#fff",e.fillRect(0,0,e.canvas.width,e.canvas.height),e.lineCap="round",e.lineJoin="round",this.paths.forEach(i=>{if(e.beginPath(),e.strokeStyle=i.color,e.lineWidth=i.width,i.points.length>0){e.moveTo(i.points[0].x,i.points[0].y);for(let t=1;t<i.points.length;t++)e.lineTo(i.points[t].x,i.points[t].y)}e.stroke()}),this.isDrawing&&this.points.length>0){e.beginPath(),e.strokeStyle=this.currentColor,e.lineWidth=this.currentWidth,e.moveTo(this.points[0].x,this.points[0].y);for(let i=1;i<this.points.length;i++)e.lineTo(this.points[i].x,this.points[i].y);e.stroke()}this.drawUI(e)}drawUI(e){e.font='bold 16px "Nunito"',e.textAlign="center",e.textBaseline="middle";for(const i of this.buttons)e.fillStyle=i.color||"#ccc",i.color===this.currentColor?(e.strokeStyle="#000",e.lineWidth=3):e.strokeStyle="transparent",e.beginPath(),e.rect(i.x,i.y,i.width,i.height),e.fill(),i.color===this.currentColor&&e.stroke(),i.text&&(e.fillStyle="black",e.fillText(i.text,i.x+i.width/2,i.y+i.height/2));e.fillStyle="#ccc",e.font='20px "Fredoka One"',e.fillText("Creative Studio",e.canvas.width/2,30)}onResize(e,i){this.createUI()}cleanup(){window.removeEventListener("mousedown",this.onMouseDown),window.removeEventListener("mousemove",this.onMouseMove),window.removeEventListener("mouseup",this.onMouseUp),window.removeEventListener("touchstart",this.onTouchStart),window.removeEventListener("touchmove",this.onTouchMove),window.removeEventListener("touchend",this.onTouchEnd)}}class T{sceneManager;isDrawing=!1;points=[];paths=[];currentColor="#ff0000";currentWidth=20;colors=["#ff0000","#00ff00","#0000ff","#ffff00","#ff00ff","#00ffff","#ffa500","#a52a2a","#ffffff"];buttons=[];images=[];loaded=!1;currentImage=0;constructor(e){this.sceneManager=e,this.loadImages()}loadImages(){const e=[new URL("/sara_game/assets/coloring_page_1-KadOgHmR.png",import.meta.url).href,new URL("/sara_game/assets/coloring_page_2-CWWBqltE.png",import.meta.url).href,new URL("/sara_game/assets/coloring_page_3-jirEjUEY.png",import.meta.url).href];let i=0;e.forEach(t=>{const n=new Image;n.src=t,n.onload=()=>{i++,i===e.length&&(this.loaded=!0)},this.images.push(n)})}init(){this.createUI(),window.addEventListener("mousedown",this.onMouseDown),window.addEventListener("mousemove",this.onMouseMove),window.addEventListener("mouseup",this.onMouseUp),window.addEventListener("touchstart",this.onTouchStart,{passive:!1}),window.addEventListener("touchmove",this.onTouchMove,{passive:!1}),window.addEventListener("touchend",this.onTouchEnd)}createUI(){this.buttons=[];let e=50;this.colors.forEach(i=>{this.buttons.push({color:i,x:e,y:window.innerHeight-80,width:50,height:50,action:()=>{this.currentColor=i,this.currentWidth=i==="#ffffff"?40:20}}),e+=60}),this.buttons.push({text:"Next Pic >",x:window.innerWidth-300,y:window.innerHeight-80,width:120,height:50,action:()=>{this.currentImage=(this.currentImage+1)%this.images.length,this.paths=[]}}),this.buttons.push({text:"Save Art",x:window.innerWidth-150,y:window.innerHeight-80,width:120,height:50,action:()=>{alert("Masterpiece Saved!")}}),this.buttons.push({text:"Back",x:window.innerWidth-100,y:20,width:80,height:40,action:()=>{this.sceneManager.switchScene(new c(this.sceneManager))}})}onMouseDown=e=>{this.checkUI(e.clientX,e.clientY)||(this.isDrawing=!0,this.points=[{x:e.clientX,y:e.clientY}])};onMouseMove=e=>{this.isDrawing&&this.points.push({x:e.clientX,y:e.clientY})};onMouseUp=e=>{this.isDrawing&&(this.isDrawing=!1,this.savePath())};onTouchStart=e=>{const i=e.touches[0];this.checkUI(i.clientX,i.clientY)||(e.preventDefault(),this.isDrawing=!0,this.points=[{x:i.clientX,y:i.clientY}])};onTouchMove=e=>{if(!this.isDrawing)return;e.preventDefault();const i=e.touches[0];this.points.push({x:i.clientX,y:i.clientY})};onTouchEnd=e=>{this.isDrawing&&(this.isDrawing=!1,this.savePath())};checkUI(e,i){for(const t of this.buttons)if(e>=t.x&&e<=t.x+t.width&&i>=t.y&&i<=t.y+t.height)return t.action(),!0;return!1}savePath(){this.points.length>0&&(this.paths.push({points:[...this.points],color:this.currentColor,width:this.currentWidth}),this.points=[])}update(e){}draw(e){if(e.fillStyle="#fff",e.fillRect(0,0,e.canvas.width,e.canvas.height),e.lineCap="round",e.lineJoin="round",this.paths.forEach(i=>{if(e.beginPath(),e.strokeStyle=i.color,e.lineWidth=i.width,i.points.length>0){e.moveTo(i.points[0].x,i.points[0].y);for(let t=1;t<i.points.length;t++)e.lineTo(i.points[t].x,i.points[t].y)}e.stroke()}),this.isDrawing&&this.points.length>0){e.beginPath(),e.strokeStyle=this.currentColor,e.lineWidth=this.currentWidth,e.moveTo(this.points[0].x,this.points[0].y);for(let i=1;i<this.points.length;i++)e.lineTo(this.points[i].x,this.points[i].y);e.stroke()}if(this.loaded&&this.images[this.currentImage]){e.globalCompositeOperation="multiply";const i=this.images[this.currentImage],t=Math.min((e.canvas.width-50)/i.width,(e.canvas.height-150)/i.height),n=i.width*t,o=i.height*t,s=(e.canvas.width-n)/2,r=(e.canvas.height-o)/2-20;e.drawImage(i,s,r,n,o),e.globalCompositeOperation="source-over"}this.drawUI(e)}onResize(e,i){this.createUI()}drawUI(e){e.font='bold 16px "Nunito"',e.textAlign="center",e.textBaseline="middle";for(const i of this.buttons)e.fillStyle=i.color||"#ccc",i.color===this.currentColor?(e.strokeStyle="#000",e.lineWidth=3):e.strokeStyle="transparent",e.beginPath(),e.rect(i.x,i.y,i.width,i.height),e.fill(),i.color===this.currentColor&&e.stroke(),i.text&&(e.fillStyle="black",e.fillText(i.text,i.x+i.width/2,i.y+i.height/2));e.fillStyle="#333",e.font="30px 'Fredoka One'",e.fillText("Coloring Book",e.canvas.width/2,50)}cleanup(){window.removeEventListener("mousedown",this.onMouseDown),window.removeEventListener("mousemove",this.onMouseMove),window.removeEventListener("mouseup",this.onMouseUp),window.removeEventListener("touchstart",this.onTouchStart),window.removeEventListener("touchmove",this.onTouchMove),window.removeEventListener("touchend",this.onTouchEnd)}}const w=[[[1,1,1,1]],[[1,0,0],[1,1,1]],[[0,0,1],[1,1,1]],[[1,1],[1,1]],[[0,1,1],[1,1,0]],[[0,1,0],[1,1,1]],[[1,1,0],[0,1,1]]],M=["#00f0f0","#0000f0","#f0a000","#f0f000","#00f000","#a000f0","#f00000"];class P{sceneManager;grid;cols=10;rows=20;size=30;currentPiece=null;dropCounter=0;dropInterval=1e3;score=0;gameOver=!1;constructor(e){this.sceneManager=e,this.grid=Array.from({length:this.rows},()=>Array(this.cols).fill(null))}init(){this.reset(),window.addEventListener("keydown",this.handleInput),window.addEventListener("touchstart",this.handleTouch,{passive:!1}),window.addEventListener("pointerup",this.handleClick)}handleClick=e=>{const i=window.innerWidth;e.clientX>i-100&&e.clientY<80?this.sceneManager.switchScene(new c(this.sceneManager)):this.gameOver&&this.reset()};reset(){this.grid=Array.from({length:this.rows},()=>Array(this.cols).fill(null)),this.score=0,this.gameOver=!1,this.spawnPiece()}spawnPiece(){const e=Math.floor(Math.random()*w.length);this.currentPiece={shape:w[e],color:M[e],x:3,y:0},this.collide(this.grid,this.currentPiece)&&(this.gameOver=!0,this.currentPiece=null)}handleInput=e=>{if(this.gameOver){e.key==="Enter"&&this.reset(),e.key==="Escape"&&this.sceneManager.switchScene(new c(this.sceneManager));return}this.currentPiece&&(e.key==="ArrowLeft"?(this.currentPiece.x--,this.collide(this.grid,this.currentPiece)&&this.currentPiece.x++):e.key==="ArrowRight"?(this.currentPiece.x++,this.collide(this.grid,this.currentPiece)&&this.currentPiece.x--):e.key==="ArrowDown"?this.drop():e.key==="ArrowUp"&&this.rotate())};rotate(){if(!this.currentPiece)return;const e=this.currentPiece.shape,i=e[0].map((n,o)=>e.map(s=>s[o]).reverse()),t=this.currentPiece.shape;this.currentPiece.shape=i,this.collide(this.grid,this.currentPiece)&&(this.currentPiece.shape=t)}handleTouch=e=>{const i=e.touches[0].clientX,t=window.innerWidth;if(this.gameOver){this.reset();return}i<t*.3?this.currentPiece&&(this.currentPiece.x--,this.collide(this.grid,this.currentPiece)&&this.currentPiece.x++):i>t*.7?this.currentPiece&&(this.currentPiece.x++,this.collide(this.grid,this.currentPiece)&&this.currentPiece.x--):this.rotate()};collide(e,i){for(let t=0;t<i.shape.length;t++)for(let n=0;n<i.shape[t].length;n++)if(i.shape[t][n]!==0){const o=i.y+t,s=i.x+n;if(o>=this.rows||s<0||s>=this.cols||o>=0&&e[o][s])return!0}return!1}merge(e,i){for(let t=0;t<i.shape.length;t++)for(let n=0;n<i.shape[t].length;n++)if(i.shape[t][n]!==0){const o=i.y+t,s=i.x+n;o>=0&&o<this.rows&&s>=0&&s<this.cols&&(e[o][s]=i.color)}}arenaSweep(){let e=1;e:for(let i=this.rows-1;i>0;--i){for(let n=0;n<this.cols;++n)if(!this.grid[i][n])continue e;const t=this.grid.splice(i,1)[0].fill(null);this.grid.unshift(t),++i,this.score+=e*10,e*=2}u.getInstance().updateHighScore("tetris",this.score)}drop(){this.currentPiece&&(this.currentPiece.y++,this.collide(this.grid,this.currentPiece)&&(this.currentPiece.y--,this.merge(this.grid,this.currentPiece),this.spawnPiece(),this.arenaSweep()),this.dropCounter=0)}update(e){this.gameOver||(this.dropCounter+=e,this.dropCounter>this.dropInterval&&this.drop())}draw(e){e.fillStyle="#222",e.fillRect(0,0,e.canvas.width,e.canvas.height);const i=this.cols*this.size,t=this.rows*this.size,n=(e.canvas.width-i)/2,o=(e.canvas.height-t)/2;e.save(),e.translate(n,o),e.strokeStyle="#333",e.strokeRect(0,0,i,t);for(let s=0;s<this.rows;s++)for(let r=0;r<this.cols;r++)this.grid[s][r]&&this.drawBlock(e,r,s,this.grid[s][r]);if(this.currentPiece)for(let s=0;s<this.currentPiece.shape.length;s++)for(let r=0;r<this.currentPiece.shape[s].length;r++)this.currentPiece.shape[s][r]!==0&&this.drawBlock(e,this.currentPiece.x+r,this.currentPiece.y+s,this.currentPiece.color);e.restore(),e.fillStyle="white",e.font="24px 'Nunito'",e.textAlign="left",e.fillText(`Score: ${this.score}`,20,40),this.gameOver&&(e.fillStyle="rgba(0,0,0,0.8)",e.fillRect(0,0,e.canvas.width,e.canvas.height),e.fillStyle="white",e.textAlign="center",e.font="40px 'Fredoka One'",e.fillText("GAME OVER",e.canvas.width/2,e.canvas.height/2),e.font="20px 'Nunito'",e.fillText("Tap / Enter to Restart",e.canvas.width/2,e.canvas.height/2+40)),e.fillStyle="#95a5a6",e.fillRect(e.canvas.width-100,20,80,40),e.fillStyle="white",e.font='20px "Nunito"',e.textAlign="center",e.textBaseline="middle",e.fillText("Back",e.canvas.width-60,40)}drawBlock(e,i,t,n){e.fillStyle=n,e.fillRect(i*this.size,t*this.size,this.size-1,this.size-1),e.fillStyle="rgba(255,255,255,0.3)",e.fillRect(i*this.size,t*this.size,this.size-1,4)}onResize(e,i){this.size=Math.min(e/15,i/25)}cleanup(){window.removeEventListener("keydown",this.handleInput),window.removeEventListener("touchstart",this.handleTouch),window.removeEventListener("pointerup",this.handleClick)}}class v{static init(){}static drawCharacter(e,i,t,n,o){e.save(),e.translate(i,t),e.scale(n,n);const s=o.hairColor||"#ffffff",r=o.hairStyle%10;this.drawBackHair(e,r,s),this.drawBody(e),this.drawHead(e),this.drawFace(e),o.outfit%2===0?this.drawDress(e,o.outfitColor||"#ff9ff3"):this.drawShirtSkirt(e,o.outfitColor||"#ff9ff3"),this.drawFrontHair(e,r,s),o.pet&&this.drawPet(e,o.pet),e.restore()}static roundRect(e,i,t,n,o,s){e.roundRect?e.roundRect(i,t,n,o,s):e.rect(i,t,n,o)}static drawBody(e){e.fillStyle="#ffe0bd",e.fillRect(-8,30,16,15),e.beginPath(),this.roundRect(e,-38,45,12,45,6),this.roundRect(e,26,45,12,45,6),e.fill(),e.beginPath(),e.moveTo(-15,90),e.lineTo(-18,140),e.quadraticCurveTo(-10,145,-5,140),e.lineTo(-5,90),e.fill(),e.beginPath(),e.moveTo(15,90),e.lineTo(18,140),e.quadraticCurveTo(10,145,5,140),e.lineTo(5,90),e.fill(),e.beginPath(),this.roundRect(e,-25,40,50,60,10),e.fill()}static drawHead(e){e.fillStyle="#ffe0bd",e.beginPath(),e.moveTo(-48,-20),e.bezierCurveTo(-48,40,-25,65,0,65),e.bezierCurveTo(25,65,48,40,48,-20),e.bezierCurveTo(48,-75,-48,-75,-48,-20),e.fill()}static drawFace(e){e.fillStyle="rgba(255, 100, 100, 0.2)",e.beginPath(),e.ellipse(-30,25,12,7,0,0,Math.PI*2),e.fill(),e.beginPath(),e.ellipse(30,25,12,7,0,0,Math.PI*2),e.fill(),this.drawAnimeEye(e,-22,5,!1),this.drawAnimeEye(e,22,5,!0),e.strokeStyle="#b08d76",e.lineWidth=2.5,e.lineCap="round",e.beginPath(),e.moveTo(-35,-12),e.quadraticCurveTo(-22,-16,-10,-12),e.stroke(),e.beginPath(),e.moveTo(35,-12),e.quadraticCurveTo(22,-16,10,-12),e.stroke(),e.strokeStyle="#8a5a44",e.beginPath(),e.arc(0,30,5,.1,Math.PI-.1),e.stroke()}static drawAnimeEye(e,i,t,n){e.save(),e.translate(i,t),e.fillStyle="#fff",e.beginPath(),e.ellipse(0,0,14,18,0,0,Math.PI*2),e.fill();const o=e.createLinearGradient(0,-10,0,10);o.addColorStop(0,"#555"),o.addColorStop(1,"#222"),e.fillStyle=o,e.beginPath(),e.ellipse(0,3,10,12,0,0,Math.PI*2),e.fill(),e.fillStyle="#000",e.beginPath(),e.arc(0,5,4,0,Math.PI*2),e.fill(),e.fillStyle="#fff",e.beginPath(),e.arc(-5,-6,4.5,0,Math.PI*2),e.fill(),e.globalAlpha=.6,e.beginPath(),e.arc(4,6,2.5,0,Math.PI*2),e.fill(),e.globalAlpha=1,e.fillStyle="#2d3436",e.beginPath(),n?(e.moveTo(-14,-6),e.quadraticCurveTo(0,-18,16,-4),e.lineTo(18,-8),e.quadraticCurveTo(0,-24,-16,-8)):(e.moveTo(14,-6),e.quadraticCurveTo(0,-18,-16,-4),e.lineTo(-18,-8),e.quadraticCurveTo(0,-24,16,-8)),e.fill(),e.restore()}static drawDress(e,i){e.fillStyle=i,e.beginPath(),e.moveTo(-22,40),e.lineTo(22,40),e.lineTo(24,85),e.lineTo(-24,85),e.fill(),e.beginPath(),e.arc(-32,50,14,0,Math.PI*2),e.fill(),e.beginPath(),e.arc(32,50,14,0,Math.PI*2),e.fill(),e.beginPath(),e.moveTo(-24,85),e.quadraticCurveTo(-60,120,-55,145),e.quadraticCurveTo(0,160,55,145),e.quadraticCurveTo(60,120,24,85),e.fill(),e.fillStyle="#ff7675",e.beginPath(),e.arc(0,85,6,0,Math.PI*2),e.fill(),e.beginPath(),e.ellipse(-10,85,8,5,-.4,0,Math.PI*2),e.fill(),e.beginPath(),e.ellipse(10,85,8,5,.4,0,Math.PI*2),e.fill()}static drawShirtSkirt(e,i){e.fillStyle="#fff",e.fillRect(-24,40,48,50),e.beginPath(),e.ellipse(-32,50,12,10,.3,0,Math.PI*2),e.fill(),e.beginPath(),e.ellipse(32,50,12,10,-.3,0,Math.PI*2),e.fill(),e.fillStyle=i,e.beginPath(),e.moveTo(-24,90),e.lineTo(24,90),e.lineTo(45,135),e.lineTo(-45,135),e.fill(),e.strokeStyle="rgba(0,0,0,0.1)",e.lineWidth=2,e.beginPath(),e.moveTo(-10,90),e.lineTo(-15,135),e.stroke(),e.beginPath(),e.moveTo(10,90),e.lineTo(15,135),e.stroke()}static drawBackHair(e,i,t){e.fillStyle=t,e.beginPath(),i===0?(e.moveTo(-50,-20),e.bezierCurveTo(-75,40,-80,140,-20,160),e.quadraticCurveTo(0,150,20,160),e.bezierCurveTo(80,140,75,40,50,-20)):i===1?(e.arc(0,-20,52,Math.PI,0),e.lineTo(52,40),e.quadraticCurveTo(40,60,0,55),e.quadraticCurveTo(-40,60,-52,40),e.lineTo(-52,-20)):i===2?(e.moveTo(-45,-30),e.bezierCurveTo(-90,-10,-100,100,-80,130),e.quadraticCurveTo(-70,140,-60,110),e.bezierCurveTo(-50,60,-50,10,-45,-30),e.moveTo(45,-30),e.bezierCurveTo(90,-10,100,100,80,130),e.quadraticCurveTo(70,140,60,110),e.bezierCurveTo(50,60,50,10,45,-30)):i===3?e.arc(0,-50,30,0,Math.PI*2):i===4?(e.arc(0,-25,50,Math.PI,0),e.lineTo(48,10),e.quadraticCurveTo(0,25,-48,10),e.lineTo(-50,-25)):i===6?(e.arc(0,-25,60,Math.PI,0),e.bezierCurveTo(70,0,90,80,60,120),e.quadraticCurveTo(0,140,-60,120),e.bezierCurveTo(-90,80,-70,0,-60,-25)):i===8&&(e.moveTo(-40,0),e.lineTo(-50,80),e.quadraticCurveTo(-45,90,-40,80),e.lineTo(-30,0),e.moveTo(40,0),e.lineTo(50,80),e.quadraticCurveTo(45,90,40,80),e.lineTo(30,0)),i!==9&&e.fill()}static drawFrontHair(e,i,t){e.fillStyle=t,i!==9&&(i!==7&&(e.beginPath(),e.arc(0,-25,50,Math.PI,0),e.fill()),e.beginPath(),i===7?(e.moveTo(-50,-20),e.lineTo(-30,-60),e.lineTo(-10,-30),e.lineTo(10,-70),e.lineTo(30,-30),e.lineTo(50,-50),e.lineTo(50,0),e.quadraticCurveTo(0,-10,-50,0)):i===3||i===4?(e.moveTo(-50,-25),e.quadraticCurveTo(0,-40,50,-25),e.lineTo(50,-5),e.quadraticCurveTo(0,-15,-50,-5)):(e.moveTo(-52,-30),e.bezierCurveTo(-50,-85,50,-85,52,-30),e.lineTo(52,-5),e.quadraticCurveTo(40,-15,35,0),e.quadraticCurveTo(25,-20,15,0),e.quadraticCurveTo(5,-20,0,-5),e.quadraticCurveTo(-5,-20,-15,0),e.quadraticCurveTo(-25,-20,-35,0),e.quadraticCurveTo(-40,-15,-52,-5)),e.closePath(),e.fill(),i===2?(e.fillStyle="#ff7675",e.beginPath(),e.arc(-50,-25,6,0,Math.PI*2),e.fill(),e.beginPath(),e.arc(50,-25,6,0,Math.PI*2),e.fill()):i===3?(e.fillStyle="#ff7675",e.beginPath(),e.rect(-10,-55,20,10),e.fill()):i===5&&(e.fillStyle=t,e.beginPath(),e.ellipse(45,10,15,40,.4,0,Math.PI*2),e.fill(),e.fillStyle="#fab1a0",e.beginPath(),e.arc(38,-10,6,0,Math.PI*2),e.fill()))}static drawPet(e,i){e.save(),e.translate(70,90);const t=.7;e.scale(t,t),i==="cat"?(e.fillStyle="#fdb",e.beginPath(),e.arc(0,0,18,0,Math.PI*2),e.fill(),e.fillStyle="#000",e.beginPath(),e.arc(-6,-2,2.5,0,Math.PI*2),e.arc(6,-2,2.5,0,Math.PI*2),e.fill(),e.beginPath(),e.moveTo(-12,-12),e.lineTo(-18,-30),e.lineTo(-6,-14),e.fill(),e.beginPath(),e.moveTo(12,-12),e.lineTo(18,-30),e.lineTo(6,-14),e.fill(),e.fillStyle="pink",e.beginPath(),e.ellipse(0,2,3,2,0,0,Math.PI*2),e.fill()):i==="dog"?(e.fillStyle="#dfe6e9",e.beginPath(),e.arc(0,0,20,0,Math.PI*2),e.fill(),e.fillStyle="#2d3436",e.beginPath(),e.ellipse(-15,2,8,16,.4,0,Math.PI*2),e.fill(),e.beginPath(),e.ellipse(15,2,8,16,-.4,0,Math.PI*2),e.fill(),e.fillStyle="black",e.beginPath(),e.arc(-6,-3,2.5,0,Math.PI*2),e.arc(6,-3,2.5,0,Math.PI*2),e.fill(),e.beginPath(),e.ellipse(0,4,5,3,0,0,Math.PI*2),e.fill()):i==="dragon"&&(e.fillStyle="#fdcb6e",e.beginPath(),e.moveTo(-20,20),e.lineTo(20,20),e.lineTo(0,-25),e.fill(),e.fillStyle="#55efc4",e.beginPath(),e.ellipse(-14,-8,18,10,-.4,0,Math.PI*2),e.fill(),e.beginPath(),e.ellipse(14,-8,18,10,.4,0,Math.PI*2),e.fill(),e.fillStyle="black",e.beginPath(),e.arc(-5,-6,2.5,0,Math.PI*2),e.arc(5,-6,2.5,0,Math.PI*2),e.fill()),e.restore()}}class C{sceneManager;playerX=1;playerY=1;tileSize=40;currentLevelIndex=0;isDragging=!1;lastMoveTime=0;levels=[[[0,0,0,0,0,0,0,0,0,0,0,0],[0,2,1,1,0,1,1,1,1,1,1,0],[0,0,0,1,0,1,0,0,0,0,1,0],[0,1,1,1,1,1,1,0,1,1,1,0],[0,1,0,0,0,0,1,0,0,0,1,0],[0,1,1,1,0,1,1,1,0,3,1,0],[0,0,0,0,0,0,0,0,0,0,0,0]],[[0,0,0,0,0,0,0,0,0,0,0,0,0],[0,2,1,1,1,1,0,1,1,1,1,1,0],[0,0,0,0,0,1,0,1,0,0,0,1,0],[0,1,1,1,0,1,0,1,1,1,0,1,0],[0,1,0,1,0,1,1,1,0,1,0,1,0],[0,1,0,0,0,0,0,0,0,1,0,1,0],[0,1,1,1,1,1,1,1,1,1,0,3,0],[0,0,0,0,0,0,0,0,0,0,0,0,0]],[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,2,1,0,1,1,1,1,0,1,1,1,1,1,0],[0,1,0,0,1,0,0,1,0,0,0,0,0,1,0],[0,1,1,1,1,0,1,1,1,1,1,1,0,1,0],[0,0,0,0,1,0,0,0,0,0,0,1,0,1,0],[0,1,1,1,1,1,1,1,1,1,0,1,0,1,0],[0,1,0,0,0,0,0,0,0,1,0,1,0,1,0],[0,1,1,1,0,1,1,1,1,1,1,1,0,3,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]]];currentLevel;constructor(e){this.sceneManager=e,this.currentLevel=this.levels[0],this.findStart()}findStart(){for(let e=0;e<this.currentLevel.length;e++)for(let i=0;i<this.currentLevel[e].length;i++)if(this.currentLevel[e][i]===2){this.playerX=i,this.playerY=e;return}}init(){console.log("DEBUG: MazeScene Init (Rewritten)"),window.addEventListener("keydown",this.handleInput),window.addEventListener("mousedown",this.handleStart),window.addEventListener("mousemove",this.handleMove),window.addEventListener("mouseup",this.handleEnd),window.addEventListener("touchstart",this.handleStart,{passive:!1}),window.addEventListener("touchmove",this.handleMove,{passive:!1}),window.addEventListener("touchend",this.handleEnd)}handleStart=e=>{let i,t;if(e instanceof MouseEvent?(i=e.clientX,t=e.clientY):(i=e.touches[0].clientX,t=e.touches[0].clientY),i>window.innerWidth-100&&t<80){this.sceneManager.switchScene(new c(this.sceneManager));return}const{offsetX:n,offsetY:o}=this.getOffsets(),s=n+this.playerX*this.tileSize,r=o+this.playerY*this.tileSize;i>=s-10&&i<=s+this.tileSize+10&&t>=r-10&&t<=r+this.tileSize+10&&(this.isDragging=!0),e.type==="touchstart"&&e.preventDefault()};handleMove=e=>{if(!this.isDragging)return;let i,t;e instanceof MouseEvent?(i=e.clientX,t=e.clientY):(i=e.touches[0].clientX,t=e.touches[0].clientY),e.type==="touchmove"&&e.preventDefault();const{offsetX:n,offsetY:o}=this.getOffsets(),s=Math.floor((i-n)/this.tileSize),r=Math.floor((t-o)/this.tileSize),h=s-this.playerX,a=r-this.playerY;Math.abs(h)+Math.abs(a)===1&&this.attemptMove(h,a)};handleEnd=()=>{this.isDragging=!1};handleInput=e=>{let i=0,t=0;e.key==="ArrowUp"&&(t=-1),e.key==="ArrowDown"&&(t=1),e.key==="ArrowLeft"&&(i=-1),e.key==="ArrowRight"&&(i=1),this.attemptMove(i,t)};attemptMove(e,i){const t=Date.now();if(t-this.lastMoveTime<100)return;const n=this.playerX+e,o=this.playerY+i;o>=0&&o<this.currentLevel.length&&n>=0&&n<this.currentLevel[o].length&&this.currentLevel[o][n]!==0&&(this.playerX=n,this.playerY=o,this.lastMoveTime=t,this.currentLevel[o][n]===3&&this.nextLevel())}nextLevel(){this.currentLevelIndex++,this.currentLevelIndex<this.levels.length?(this.currentLevel=this.levels[this.currentLevelIndex],this.findStart(),this.isDragging=!1):this.sceneManager.switchScene(new c(this.sceneManager))}getOffsets(){const e=(window.innerWidth-this.currentLevel[0].length*this.tileSize)/2,i=(window.innerHeight-this.currentLevel.length*this.tileSize)/2;return{offsetX:e,offsetY:i}}update(e){}draw(e){const i=e.canvas.width,t=e.canvas.height;e.fillStyle="#2c3e50",e.fillRect(0,0,i,t);const{offsetX:n,offsetY:o}=this.getOffsets();for(let h=0;h<this.currentLevel.length;h++)for(let a=0;a<this.currentLevel[h].length;a++){const f=this.currentLevel[h][a],d=n+a*this.tileSize,g=o+h*this.tileSize;f===0?(e.fillStyle="#34495e",e.fillRect(d,g,this.tileSize,this.tileSize)):(e.fillStyle="#ecf0f1",e.fillRect(d,g,this.tileSize,this.tileSize),f===3&&(e.fillStyle="#e74c3c",e.fillRect(d+10,g+10,this.tileSize-20,this.tileSize-20)))}const s=n+this.playerX*this.tileSize+this.tileSize/2,r=o+this.playerY*this.tileSize+this.tileSize/2;this.isDragging&&(e.beginPath(),e.arc(s,r,30,0,Math.PI*2),e.fillStyle="rgba(255, 234, 167, 0.4)",e.fill()),v.drawCharacter(e,s,r,.4,u.getInstance().character),e.fillStyle="white",e.font='20px "Nunito"',e.textAlign="left",e.fillText(`Level ${this.currentLevelIndex+1}`,20,40),e.fillText("Click & Hold Sara to Move!",20,70),e.fillStyle="#95a5a6",e.fillRect(i-100,20,80,40),e.fillStyle="white",e.fillText("Back",i-60,45)}onResize(e,i){}cleanup(){window.removeEventListener("keydown",this.handleInput),window.removeEventListener("mousedown",this.handleStart),window.removeEventListener("mousemove",this.handleMove),window.removeEventListener("mouseup",this.handleEnd),window.removeEventListener("touchstart",this.handleStart),window.removeEventListener("touchmove",this.handleMove),window.removeEventListener("touchend",this.handleEnd)}}class I{sceneManager;tiles=[];gridSize=3;tileSize=100;solved=!1;constructor(e){this.sceneManager=e}init(){this.resetPuzzle(),window.addEventListener("click",this.handleClick.bind(this))}resetPuzzle(){this.tiles=[0,1,2,3,4,5,6,7,8];for(let e=0;e<20;e++)this.randomMove();this.solved=!1}randomMove(){const e=this.tiles.indexOf(8),i=this.getNeighbors(e),t=i[Math.floor(Math.random()*i.length)];this.swap(e,t)}getNeighbors(e){const i=[],t=e%this.gridSize,n=Math.floor(e/this.gridSize);return t>0&&i.push(e-1),t<this.gridSize-1&&i.push(e+1),n>0&&i.push(e-this.gridSize),n<this.gridSize-1&&i.push(e+this.gridSize),i}handleClick(e){if(e.clientX>window.innerWidth-100&&e.clientY<80){this.sceneManager.switchScene(new c(this.sceneManager));return}if(this.solved){this.resetPuzzle();return}const i=window.innerWidth/2,t=window.innerHeight/2,n=i-this.gridSize*this.tileSize/2,o=t-this.gridSize*this.tileSize/2,s=e.clientX-n,r=e.clientY-o;if(s>=0&&s<this.gridSize*this.tileSize&&r>=0&&r<this.gridSize*this.tileSize){const h=Math.floor(s/this.tileSize),f=Math.floor(r/this.tileSize)*this.gridSize+h;this.tryMove(f),this.checkWin()}}tryMove(e){const i=this.tiles.indexOf(8);this.getNeighbors(i).includes(e)&&this.swap(e,i)}swap(e,i){const t=this.tiles[e];this.tiles[e]=this.tiles[i],this.tiles[i]=t}checkWin(){for(let e=0;e<this.tiles.length;e++)if(this.tiles[e]!==e)return;this.solved=!0}update(e){}draw(e){e.fillStyle="#9b59b6",e.fillRect(0,0,e.canvas.width,e.canvas.height);const i=e.canvas.width/2,t=e.canvas.height/2,n=i-this.gridSize*this.tileSize/2,o=t-this.gridSize*this.tileSize/2;e.font='bold 30px "Fredoka One"',e.textAlign="center",e.fillStyle="white",e.fillText("Picture Puzzle",i,50),this.solved&&e.fillText("SOLVED! Click to Shuffle",i,t+200);for(let s=0;s<this.tiles.length;s++){const r=this.tiles[s];if(r===8&&!this.solved)continue;const h=s%this.gridSize,a=Math.floor(s/this.gridSize),f=n+h*this.tileSize,d=o+a*this.tileSize;e.fillStyle="#ecf0f1",e.fillRect(f+2,d+2,this.tileSize-4,this.tileSize-4),e.fillStyle="#2c3e50",e.fillText((r+1).toString(),f+this.tileSize/2,d+this.tileSize/2+10)}e.font='20px "Nunito"',e.textAlign="center",e.fillStyle="#95a5a6",e.fillRect(e.canvas.width-100,20,80,40),e.fillStyle="white",e.fillText("Back",e.canvas.width-60,45)}onResize(e,i){}cleanup(){window.removeEventListener("click",this.handleClick.bind(this))}}class E{sceneManager;isRunning=!1;score=0;speed=6;gameTime=0;highScore=0;horseY=0;velocityY=0;gravity=.6;jumpForce=-13;isGrounded=!0;groundY=0;obstacles=[];clouds=[];mountains=[];spawnTimer=0;constructor(e){this.sceneManager=e,this.highScore=Number(localStorage.getItem("sara_runner_highscore"))||0}init(){this.onResize(window.innerWidth,window.innerHeight),this.resetGame(),this.initBackground(),window.addEventListener("keydown",this.handleInput),window.addEventListener("mousedown",this.handleJump),window.addEventListener("touchstart",this.handleJump,{passive:!1})}initBackground(){for(let i=0;i<5;i++)this.clouds.push({x:Math.random()*window.innerWidth,y:Math.random()*(window.innerHeight/2),size:30+Math.random()*40,speed:.5+Math.random()*.5});let e=0;for(;e<window.innerWidth+200;)this.mountains.push({x:e,height:100+Math.random()*150}),e+=80+Math.random()*100}resetGame(){this.isRunning=!0,this.score=0,this.speed=7,this.horseY=this.groundY,this.velocityY=0,this.obstacles=[],this.gameTime=0}handleInput=e=>{(e.code==="Space"||e.key==="ArrowUp")&&this.isRunning?this.handleJump():!this.isRunning&&this.gameTime>10&&this.resetGame()};handleJump=e=>{if(e){let i,t;if(e instanceof MouseEvent?(i=e.clientX,t=e.clientY):(i=e.touches[0].clientX,t=e.touches[0].clientY),i>window.innerWidth-100&&t<80){this.sceneManager.switchScene(new c(this.sceneManager));return}e.type==="touchstart"&&e.preventDefault()}this.isRunning&&this.isGrounded?(this.velocityY=this.jumpForce,this.isGrounded=!1):!this.isRunning&&this.gameTime>10&&this.resetGame()};handleTouch=e=>{this.handleJump(e)};handleClick=e=>{this.handleJump(e)};update(e){if(this.gameTime++,this.clouds.forEach(i=>{i.x-=i.speed,i.x<-100&&(i.x=window.innerWidth+100)}),!!this.isRunning){if(this.score++,this.speed+=.0015,this.score>this.highScore&&(this.highScore=this.score,localStorage.setItem("sara_runner_highscore",this.highScore.toString())),this.velocityY+=this.gravity,this.horseY+=this.velocityY,this.horseY>=this.groundY&&(this.horseY=this.groundY,this.velocityY=0,this.isGrounded=!0),this.mountains.forEach(i=>{i.x-=this.speed*.2,i.x<-200&&(i.x+=window.innerWidth+400)}),this.spawnTimer++,this.spawnTimer>90+Math.random()*50){const i=Math.random()>.5?"rock":"bush";this.obstacles.push({x:window.innerWidth,y:this.groundY+10,width:50,height:50,type:i}),this.spawnTimer=0}for(let i=this.obstacles.length-1;i>=0;i--){let t=this.obstacles[i];t.x-=this.speed,t.x<-100&&this.obstacles.splice(i,1),150>t.x+10&&110<t.x+t.width-10&&this.horseY+50>t.y+10&&(this.isRunning=!1)}}}draw(e){const i=e.canvas.width,t=e.canvas.height,n=e.createLinearGradient(0,0,0,t);n.addColorStop(0,"#87CEEB"),n.addColorStop(1,"#E0F7FA"),e.fillStyle=n,e.fillRect(0,0,i,t),e.fillStyle="#6c5ce7",e.beginPath(),this.mountains.forEach(s=>{e.moveTo(s.x,t-80),e.lineTo(s.x+100,t-80-s.height),e.lineTo(s.x+200,t-80)}),e.fill(),e.fillStyle="rgba(255, 255, 255, 0.8)",this.clouds.forEach(s=>{this.drawCloud(e,s.x,s.y,s.size)}),e.fillStyle="#2ecc71",e.fillRect(0,this.groundY+40,i,t-(this.groundY+40)),e.fillStyle="#27ae60",e.fillRect(0,this.groundY+40,i,10);const o=this.isRunning&&this.isGrounded?Math.floor(this.gameTime/5)%2:2;this.drawHorse(e,100,this.horseY,o),this.obstacles.forEach(s=>{s.type==="rock"?this.drawRock(e,s.x,s.y):this.drawBush(e,s.x,s.y)}),e.fillStyle="white",e.font='bold 30px "Fredoka One"',e.textAlign="left",e.lineWidth=3,e.strokeText(`Score: ${Math.floor(this.score/10)}`,20,50),e.fillText(`Score: ${Math.floor(this.score/10)}`,20,50),e.font='20px "Nunito"',e.fillText(`High: ${Math.floor(this.highScore/10)}`,20,80),this.isRunning||(e.fillStyle="rgba(0,0,0,0.5)",e.fillRect(0,0,i,t),e.fillStyle="white",e.textAlign="center",e.font='bold 40px "Fredoka One"',e.fillText("GAME OVER",i/2,t/2-20),e.font='24px "Nunito"',e.fillText("Tap to Run Again",i/2,t/2+30)),this.drawBackButton(e)}drawBackButton(e){const i=e.canvas.width;e.fillStyle="#95a5a6",this.roundRect(e,i-110,20,90,40,10),e.fillStyle="white",e.font='bold 20px "Nunito"',e.textAlign="center",e.fillText("Back",i-65,47)}drawCloud(e,i,t,n){e.beginPath(),e.arc(i,t,n,0,Math.PI*2),e.arc(i+n*.8,t+n*.2,n*.7,0,Math.PI*2),e.arc(i-n*.8,t+n*.2,n*.7,0,Math.PI*2),e.fill()}drawHorse(e,i,t,n){e.save(),e.translate(i,t);const o=.8;e.scale(o,o),e.fillStyle="#e67e22",e.beginPath(),e.ellipse(30,30,25,15,0,0,Math.PI*2),e.fill(),e.beginPath(),e.moveTo(45,25),e.lineTo(65,5),e.lineTo(75,15),e.lineTo(65,30),e.fill(),e.fillStyle="#d35400",e.beginPath(),e.moveTo(50,15),e.lineTo(60,0),e.lineTo(65,15),e.fill(),e.strokeStyle="#e67e22",e.lineWidth=6,e.lineCap="round",e.beginPath(),n===0?(e.moveTo(20,40),e.lineTo(10,60),e.moveTo(50,40),e.lineTo(60,60)):n===1?(e.moveTo(20,40),e.lineTo(30,60),e.moveTo(50,40),e.lineTo(40,60)):(e.moveTo(20,40),e.lineTo(5,50),e.moveTo(50,40),e.lineTo(70,45)),e.stroke(),e.strokeStyle="#d35400",e.beginPath(),e.moveTo(5,30),e.quadraticCurveTo(-10,20,-15,40),e.stroke(),e.restore()}drawRock(e,i,t){e.fillStyle="#7f8c8d",e.beginPath(),e.moveTo(i,t+40),e.lineTo(i+10,t+10),e.lineTo(i+30,t+0),e.lineTo(i+50,t+40),e.closePath(),e.fill(),e.fillStyle="#95a5a6",e.beginPath(),e.moveTo(i+10,t+15),e.lineTo(i+15,t+15),e.lineTo(i+12,t+30),e.fill()}drawBush(e,i,t){e.fillStyle="#27ae60",e.beginPath(),e.arc(i+15,t+30,15,0,Math.PI*2),e.arc(i+35,t+30,15,0,Math.PI*2),e.arc(i+25,t+15,18,0,Math.PI*2),e.fill()}roundRect(e,i,t,n,o,s){e.roundRect?e.roundRect(i,t,n,o,s):e.rect(i,t,n,o),e.fill()}onResize(e,i){this.groundY=i-120}cleanup(){window.removeEventListener("keydown",this.handleInput),window.removeEventListener("mousedown",this.handleJump),window.removeEventListener("touchstart",this.handleJump)}}class c{sceneManager;buttons=[];constructor(e){this.sceneManager=e}init(){this.createUI(),this.sceneManager.getCanvas().addEventListener("pointerup",this.handleInput)}createUI(){this.buttons=[];const e=window.innerWidth,i=window.innerHeight,t=e/2,n=i/2,o=220,s=120,r=40,h=t-(o*1.5+r),a=n-(s+r/2);[{name:"Block Party",color:"#e74c3c",scene:()=>new P(this.sceneManager)},{name:"Creative Studio",color:"#f39c12",scene:()=>new b(this.sceneManager)},{name:"Coloring Book",color:"#f1c40f",scene:()=>new T(this.sceneManager)},{name:"Crystal Maze",color:"#1abc9c",scene:()=>new C(this.sceneManager)},{name:"Picture Puzzle",color:"#9b59b6",scene:()=>new I(this.sceneManager)},{name:"Horse Runner",color:"#3498db",scene:()=>new E(this.sceneManager)}].forEach((d,g)=>{const S=g%3,m=Math.floor(g/3);this.buttons.push({text:d.name,x:h+S*(o+r),y:a+m*(s+r),width:o,height:s,color:d.color,action:()=>{this.sceneManager.switchScene(d.scene())}})}),this.buttons.push({text:"Change Hero",x:20,y:20,width:140,height:40,color:"#95a5a6",action:()=>{this.sceneManager.switchScene(new p(this.sceneManager))}})}handleInput=e=>{const i=this.sceneManager.getCanvas(),t=i.getBoundingClientRect(),n=i.width/t.width,o=i.height/t.height,s=(e.clientX-t.left)*n,r=(e.clientY-t.top)*o;console.log(`Input: client(${e.clientX}, ${e.clientY}) -> canvas(${s.toFixed(0)}, ${r.toFixed(0)})`);for(const h of this.buttons)if(s>=h.x&&s<=h.x+h.width&&r>=h.y&&r<=h.y+h.height){console.log(`Action: Clicked '${h.text}'`),h.action();break}};update(e){}draw(e){e.fillStyle="#fce4ec",e.fillRect(0,0,e.canvas.width,e.canvas.height),e.fillStyle="#ff6b81",e.font="bold 50px 'Fredoka One'",e.textAlign="center",e.fillText("Game Center",e.canvas.width/2,80),e.font="bold 24px 'Nunito'",e.textBaseline="middle";for(const i of this.buttons)e.fillStyle="rgba(0,0,0,0.1)",e.beginPath(),e.roundRect(i.x+5,i.y+5,i.width,i.height,15),e.fill(),e.fillStyle=i.color,e.beginPath(),e.roundRect(i.x,i.y,i.width,i.height,15),e.fill(),e.fillStyle="white",e.fillText(i.text,i.x+i.width/2,i.y+i.height/2)}onResize(e,i){this.createUI()}cleanup(){this.sceneManager.getCanvas().removeEventListener("pointerup",this.handleInput)}}class k{sceneManager;buttons=[];lastClick=0;bgImage;constructor(e){this.sceneManager=e,this.bgImage=new Image,this.bgImage.src=new URL("/sara_game/assets/dressing_room_bg-DnjJd2gh.png",import.meta.url).href}hairColors=["#2c3e50","#e74c3c","#f1c40f","#ecf0f1","#9b59b6","#e67e22","#3498db","#2ecc71","#34495e","#ff9ff3","#5f27cd","#00d2d3"];outfitColors=["#ff6b81","#a4b0be","#7bed9f","#eccc68","#ff7f50","#70a1ff","#5352ed","#ff4757","#2f3542","#d63031","#e056fd","#686de0"];pets=[null,"cat","dog","dragon"];init(){this.createUI(),this.sceneManager.getCanvas().addEventListener("pointerup",this.handleInput)}createUI(){this.buttons=[];const e=window.innerWidth/2,i=window.innerHeight/2,t=u.getInstance(),n=200,o=50;this.buttons.push({text:"Hair Style >",x:e-350,y:i-150,width:n,height:o,action:()=>{t.character.hairStyle=(t.character.hairStyle+1)%10}}),this.buttons.push({text:"Hair Color >",x:e-350,y:i-70,width:n,height:o,action:()=>{const s=this.hairColors.indexOf(t.character.hairColor);t.character.hairColor=this.hairColors[(s+1)%this.hairColors.length]}}),this.buttons.push({text:"Your Name",x:e-350,y:i+10,width:n,height:o,action:()=>{const s=prompt("Enter your name:",t.playerName);s&&(t.playerName=s)}}),this.buttons.push({text:"Outfit >",x:e+150,y:i-150,width:n,height:o,action:()=>{t.character.outfit=(t.character.outfit+1)%8}}),this.buttons.push({text:"Outfit Color >",x:e+150,y:i-70,width:n,height:o,action:()=>{const s=this.outfitColors.indexOf(t.character.outfitColor);t.character.outfitColor=this.outfitColors[(s+1)%this.outfitColors.length]}}),this.buttons.push({text:"Pet >",x:e+150,y:i+10,width:n,height:o,action:()=>{const s=this.pets.indexOf(t.character.pet);t.character.pet=this.pets[(s+1)%this.pets.length]}}),this.buttons.push({text:"COME OUT AND PLAY!",x:e-150,y:window.innerHeight-100,width:300,height:70,color:"#2ecc71",action:()=>{t.save(),this.sceneManager.switchScene(new c(this.sceneManager))}}),this.buttons.push({text:"MAKE IT BEAUTIFUL!",x:e-150,y:100,width:300,height:50,color:"#ff9a9e",action:()=>{t.character.hairStyle=Math.floor(Math.random()*10),t.character.outfit=Math.floor(Math.random()*2),t.character.hairColor=this.hairColors[Math.floor(Math.random()*this.hairColors.length)],t.character.outfitColor=this.outfitColors[Math.floor(Math.random()*this.outfitColors.length)],t.character.pet=this.pets[Math.floor(Math.random()*this.pets.length)]}})}handleInput=e=>{const i=Date.now();if(this.lastClick&&i-this.lastClick<300)return;this.lastClick=i;const t=this.sceneManager.getCanvas(),n=t.getBoundingClientRect(),o=t.width/n.width,s=t.height/n.height,r=(e.clientX-n.left)*o,h=(e.clientY-n.top)*s;console.log(`Creator Input: ${r.toFixed(0)}, ${h.toFixed(0)}`);for(const a of this.buttons)if(r>=a.x&&r<=a.x+a.width&&h>=a.y&&h<=a.y+a.height){a.action();return}};update(e){}draw(e){const i=e.canvas.width/2,t=e.canvas.height/2;this.bgImage.complete&&this.bgImage.naturalWidth>0?e.drawImage(this.bgImage,0,0,e.canvas.width,e.canvas.height):(e.fillStyle="#f0f8ff",e.fillRect(0,0,e.canvas.width,e.canvas.height)),e.fillStyle="rgba(255, 255, 255, 0.5)",e.beginPath(),e.arc(i,t,220,0,Math.PI*2),e.fill(),v.drawCharacter(e,i,t,2,u.getInstance().character),e.textAlign="center",e.textBaseline="middle",e.font='bold 20px "Nunito"';for(const n of this.buttons)e.fillStyle=n.color||"#ccc",e.beginPath(),e.rect(n.x,n.y,n.width,n.height),e.fill(),e.fillStyle="white",e.fillText(n.text,n.x+n.width/2,n.y+n.height/2);e.fillStyle="#555",e.font='bold 36px "Fredoka One"',e.fillText("Design Your Style",i,60)}onResize(e,i){this.createUI()}cleanup(){this.sceneManager.getCanvas().removeEventListener("pointerup",this.handleInput)}}class p{sceneManager;buttons=[];constructor(e){this.sceneManager=e}init(){console.log("DEBUG: TitleScene Init"),this.createUI(),this.sceneManager.getCanvas().addEventListener("pointerup",this.handleInput)}handleInput=e=>{const t=this.sceneManager.getCanvas().getBoundingClientRect(),n=e.clientX-t.left,o=e.clientY-t.top;for(const s of this.buttons)n>=s.x&&n<=s.x+s.width&&o>=s.y&&o<=s.y+s.height&&s.action()};createUI(){this.buttons=[];const e=window.innerWidth,i=window.innerHeight,t=200,n=300,o=50,s=(e-(3*t+2*o))/2,r=i/2-n/2,h=["sara","lara","sofia"],a=["#ff9a9e","#a18cd1","#4facfe"];h.forEach((f,d)=>{this.buttons.push({text:f.charAt(0).toUpperCase()+f.slice(1),x:s+d*(t+o),y:r,width:t,height:n,color:a[d],action:()=>{u.getInstance().currentSlot=f,u.getInstance().load(),this.sceneManager.switchScene(new k(this.sceneManager))}})})}update(e){}draw(e){const i=e.createLinearGradient(0,0,0,e.canvas.height);i.addColorStop(0,"#a18cd1"),i.addColorStop(1,"#fbc2eb"),e.fillStyle=i,e.fillRect(0,0,e.canvas.width,e.canvas.height),e.fillStyle="white",e.font='bold 60px "Fredoka One"',e.textAlign="center",e.fillText("Who are you today?",e.canvas.width/2,100);for(const t of this.buttons)e.fillStyle="rgba(0,0,0,0.2)",e.beginPath(),e.roundRect?e.roundRect(t.x+10,t.y+10,t.width,t.height,20):e.rect(t.x+10,t.y+10,t.width,t.height),e.fill(),e.fillStyle=t.color,e.beginPath(),e.roundRect?e.roundRect(t.x,t.y,t.width,t.height,20):e.rect(t.x,t.y,t.width,t.height),e.fill(),e.fillStyle="rgba(255,255,255,0.3)",e.beginPath(),e.roundRect?e.roundRect(t.x+10,t.y+10,t.width-20,t.height-80,15):e.rect(t.x+10,t.y+10,t.width-20,t.height-80),e.fill(),e.fillStyle="rgba(255,255,255,0.8)",e.beginPath(),e.arc(t.x+t.width/2,t.y+100,60,0,Math.PI*2),e.fill(),e.fillStyle="white",e.font='bold 36px "Nunito"',e.fillText(t.text,t.x+t.width/2,t.y+t.height-30)}onResize(e,i){this.createUI()}cleanup(){this.sceneManager.getCanvas().removeEventListener("pointerup",this.handleInput)}}document.addEventListener("DOMContentLoaded",()=>{const l=document.getElementById("gameCanvas");console.log("GAME VERSION: Mobile Fix 2.0 (Loaded)"),u.getInstance().load();const e=new y(l);e.switchScene(new p(e))});
