(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))t(s);new MutationObserver(s=>{for(const r of s)if(r.type==="childList")for(const n of r.addedNodes)n.tagName==="LINK"&&n.rel==="modulepreload"&&t(n)}).observe(document,{childList:!0,subtree:!0});function i(s){const r={};return s.integrity&&(r.integrity=s.integrity),s.referrerPolicy&&(r.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?r.credentials="include":s.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function t(s){if(s.ep)return;s.ep=!0;const r=i(s);fetch(s.href,r)}})();class C{currentScene=null;canvas;ctx;lastTime=0;constructor(e){this.canvas=e;const i=e.getContext("2d");if(!i)throw new Error("Could not get 2D context");this.ctx=i,this.loop=this.loop.bind(this),requestAnimationFrame(this.loop),window.addEventListener("resize",()=>{this.resize()}),this.resize()}getCanvas(){return this.canvas}switchScene(e){console.log(`DEBUG: SwitchScene: ${e.constructor.name}`),this.currentScene&&this.currentScene.cleanup(),this.currentScene=e,this.currentScene.init(),this.currentScene.onResize(this.canvas.width,this.canvas.height)}resize(){this.canvas.width=window.innerWidth,this.canvas.height=window.innerHeight,this.currentScene&&this.currentScene.onResize(this.canvas.width,this.canvas.height)}loop(e){const i=e-this.lastTime;this.lastTime=e,this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.currentScene&&(this.currentScene.update(i),this.currentScene.draw(this.ctx)),requestAnimationFrame(this.loop)}}class w{static instance;currentSlot="sara";slots={};constructor(){this.slots={sara:this.createDefaultSlot("Sara"),lara:this.createDefaultSlot("Lara"),sofia:this.createDefaultSlot("Sofia")}}createDefaultSlot(e){return{playerName:e,character:{hairStyle:0,hairColor:"#ff9a9e",outfit:0,outfitColor:"#a18cd1",skinTone:"#f5d0b0",pet:null},highScores:{runner:0,tetris:0}}}static getInstance(){return w.instance||(w.instance=new w),w.instance}get playerName(){return this.slots[this.currentSlot].playerName}set playerName(e){this.slots[this.currentSlot].playerName=e,this.save()}get character(){return this.slots[this.currentSlot].character}set character(e){this.slots[this.currentSlot].character=e,this.save()}get highScores(){return this.slots[this.currentSlot].highScores}updateHighScore(e,i){const t=this.slots[this.currentSlot].highScores[e]||0;i>t&&(this.slots[this.currentSlot].highScores[e]=i,this.save())}save(){localStorage.setItem("sara-demon-hunters-save-v2",JSON.stringify(this.slots))}load(){const e=localStorage.getItem("sara-demon-hunters-save-v2");if(e)try{const i=JSON.parse(e);this.slots={...this.slots,...i}}catch(i){console.error("Failed to load save data",i)}}}class P{sceneManager;isDrawing=!1;points=[];paths=[];currentColor="#000000";currentWidth=5;colors=["#000000","#FF0000","#00FF00","#0000FF","#FFFF00","#FF00FF","#00FFFF","#FFFFFF"];buttons=[];constructor(e){this.sceneManager=e}init(){this.createUI(),window.addEventListener("mousedown",this.onMouseDown),window.addEventListener("mousemove",this.onMouseMove),window.addEventListener("mouseup",this.onMouseUp),window.addEventListener("touchstart",this.onTouchStart,{passive:!1}),window.addEventListener("touchmove",this.onTouchMove,{passive:!1}),window.addEventListener("touchend",this.onTouchEnd)}createUI(){this.buttons=[];let e=100;this.colors.forEach(i=>{this.buttons.push({color:i,x:20,y:e,width:40,height:40,action:()=>{this.currentColor=i,this.currentWidth=i==="#FFFFFF"?20:5}}),e+=50}),this.buttons.push({text:"Clear",x:20,y:e+20,width:60,height:40,action:()=>{this.paths=[]}}),this.buttons.push({text:"Back",x:window.innerWidth-100,y:20,width:80,height:40,action:()=>{this.sceneManager.switchScene(new p(this.sceneManager))}})}onMouseDown=e=>{this.checkUI(e.clientX,e.clientY)||(this.isDrawing=!0,this.points=[{x:e.clientX,y:e.clientY}])};onMouseMove=e=>{this.isDrawing&&this.points.push({x:e.clientX,y:e.clientY})};onMouseUp=e=>{this.isDrawing&&(this.isDrawing=!1,this.savePath())};onTouchStart=e=>{const i=e.touches[0];this.checkUI(i.clientX,i.clientY)||(e.preventDefault(),this.isDrawing=!0,this.points=[{x:i.clientX,y:i.clientY}])};onTouchMove=e=>{if(!this.isDrawing)return;e.preventDefault();const i=e.touches[0];this.points.push({x:i.clientX,y:i.clientY})};onTouchEnd=e=>{this.isDrawing&&(this.isDrawing=!1,this.savePath())};checkUI(e,i){for(const t of this.buttons)if(e>=t.x&&e<=t.x+t.width&&i>=t.y&&i<=t.y+t.height)return t.action(),!0;return!1}savePath(){this.points.length>0&&(this.paths.push({points:[...this.points],color:this.currentColor,width:this.currentWidth}),this.points=[])}update(e){}draw(e){if(e.fillStyle="#fff",e.fillRect(0,0,e.canvas.width,e.canvas.height),e.lineCap="round",e.lineJoin="round",this.paths.forEach(i=>{if(e.beginPath(),e.strokeStyle=i.color,e.lineWidth=i.width,i.points.length>0){e.moveTo(i.points[0].x,i.points[0].y);for(let t=1;t<i.points.length;t++)e.lineTo(i.points[t].x,i.points[t].y)}e.stroke()}),this.isDrawing&&this.points.length>0){e.beginPath(),e.strokeStyle=this.currentColor,e.lineWidth=this.currentWidth,e.moveTo(this.points[0].x,this.points[0].y);for(let i=1;i<this.points.length;i++)e.lineTo(this.points[i].x,this.points[i].y);e.stroke()}this.drawUI(e)}drawUI(e){e.font='bold 16px "Nunito"',e.textAlign="center",e.textBaseline="middle";for(const i of this.buttons)e.fillStyle=i.color||"#ccc",i.color===this.currentColor?(e.strokeStyle="#000",e.lineWidth=3):e.strokeStyle="transparent",e.beginPath(),e.rect(i.x,i.y,i.width,i.height),e.fill(),i.color===this.currentColor&&e.stroke(),i.text&&(e.fillStyle="black",e.fillText(i.text,i.x+i.width/2,i.y+i.height/2));e.fillStyle="#ccc",e.font='20px "Fredoka One"',e.fillText("Creative Studio",e.canvas.width/2,30)}onResize(e,i){this.createUI()}cleanup(){window.removeEventListener("mousedown",this.onMouseDown),window.removeEventListener("mousemove",this.onMouseMove),window.removeEventListener("mouseup",this.onMouseUp),window.removeEventListener("touchstart",this.onTouchStart),window.removeEventListener("touchmove",this.onTouchMove),window.removeEventListener("touchend",this.onTouchEnd)}}class I{sceneManager;bufferCanvas;bufferCtx;currentColor={r:255,g:0,b:0};colors=[{hex:"#ff0000",rgb:{r:255,g:0,b:0}},{hex:"#dc143c",rgb:{r:220,g:20,b:60}},{hex:"#ff69b4",rgb:{r:255,g:105,b:180}},{hex:"#ffc0cb",rgb:{r:255,g:192,b:203}},{hex:"#fa8072",rgb:{r:250,g:128,b:114}},{hex:"#ff4500",rgb:{r:255,g:69,b:0}},{hex:"#ffa500",rgb:{r:255,g:165,b:0}},{hex:"#ffdab9",rgb:{r:255,g:218,b:185}},{hex:"#ffd700",rgb:{r:255,g:215,b:0}},{hex:"#ffff00",rgb:{r:255,g:255,b:0}},{hex:"#f0e68c",rgb:{r:240,g:230,b:140}},{hex:"#006400",rgb:{r:0,g:100,b:0}},{hex:"#008000",rgb:{r:0,g:128,b:0}},{hex:"#00ff00",rgb:{r:0,g:255,b:0}},{hex:"#32cd32",rgb:{r:50,g:205,b:50}},{hex:"#90ee90",rgb:{r:144,g:238,b:144}},{hex:"#00fa9a",rgb:{r:0,g:250,b:154}},{hex:"#00ced1",rgb:{r:0,g:206,b:209}},{hex:"#00ffff",rgb:{r:0,g:255,b:255}},{hex:"#87ceeb",rgb:{r:135,g:206,b:235}},{hex:"#1e90ff",rgb:{r:30,g:144,b:255}},{hex:"#0000ff",rgb:{r:0,g:0,b:255}},{hex:"#00008b",rgb:{r:0,g:0,b:139}},{hex:"#4b0082",rgb:{r:75,g:0,b:130}},{hex:"#8a2be2",rgb:{r:138,g:43,b:226}},{hex:"#800080",rgb:{r:128,g:0,b:128}},{hex:"#ff00ff",rgb:{r:255,g:0,b:255}},{hex:"#8b4513",rgb:{r:139,g:69,b:19}},{hex:"#a52a2a",rgb:{r:165,g:42,b:42}},{hex:"#f5deb3",rgb:{r:245,g:222,b:179}},{hex:"#000000",rgb:{r:0,g:0,b:0}},{hex:"#808080",rgb:{r:128,g:128,b:128}},{hex:"#ffffff",rgb:{r:255,g:255,b:255}}];buttons=[];images=[];loaded=!1;currentImageIndex=0;constructor(e){this.sceneManager=e,this.bufferCanvas=document.createElement("canvas"),this.bufferCanvas.width=window.innerWidth,this.bufferCanvas.height=window.innerHeight;const i=this.bufferCanvas.getContext("2d",{willReadFrequently:!0});if(!i)throw new Error("Could not create buffer context");this.bufferCtx=i,this.loadImages()}loadImages(){const e=[new URL("/sara_game/assets/coloring_page_1-KadOgHmR.png",import.meta.url).href,new URL("/sara_game/assets/coloring_page_2-CWWBqltE.png",import.meta.url).href,new URL("/sara_game/assets/coloring_page_3-jirEjUEY.png",import.meta.url).href,new URL("/sara_game/assets/coloring_page_castle-t3QA4wJh.png",import.meta.url).href,new URL("/sara_game/assets/coloring_page_dragon-k_0ZmbES.png",import.meta.url).href,new URL("/sara_game/assets/coloring_page_unicorn-Pz7fq0Nv.png",import.meta.url).href,new URL("/sara_game/assets/coloring_page_mermaid-BrDp468c.png",import.meta.url).href,new URL("/sara_game/assets/coloring_page_fairy_house-CqZCBJGY.png",import.meta.url).href,new URL("/sara_game/assets/coloring_page_princess-_F5__fSh.png",import.meta.url).href,new URL("/sara_game/assets/coloring_page_kitten-f2fR9YcJ.png",import.meta.url).href,new URL("/sara_game/assets/coloring_page_puppy-CkKj9wTp.png",import.meta.url).href,new URL("/sara_game/assets/coloring_page_butterfly-QIBIWY9u.png",import.meta.url).href,new URL("/sara_game/assets/coloring_page_dolphin-RDeX8vpN.png",import.meta.url).href,new URL("/sara_game/assets/coloring_page_owl-qRBjE9qZ.png",import.meta.url).href,new URL("/sara_game/assets/coloring_page_cupcake-DvqXuUOM.png",import.meta.url).href];let i=0;e.forEach(t=>{const s=new Image;s.crossOrigin="Anonymous",s.src=t,s.onload=()=>{i++,i===e.length&&(this.loaded=!0,this.resetImage())},this.images.push(s)})}resetImage(){if(!this.loaded||!this.images[this.currentImageIndex])return;this.bufferCtx.fillStyle="#ffffff",this.bufferCtx.fillRect(0,0,this.bufferCanvas.width,this.bufferCanvas.height);const e=this.images[this.currentImageIndex],i=this.bufferCanvas.width-50,t=this.bufferCanvas.height-150,s=Math.min(i/e.width,t/e.height),r=e.width*s,n=e.height*s,o=(this.bufferCanvas.width-r)/2,a=(this.bufferCanvas.height-n)/2-20;this.bufferCtx.drawImage(e,o,a,r,n)}init(){console.log("DEBUG: ColoringScene Init (Flood Fill)"),this.createUI(),this.sceneManager.getCanvas().addEventListener("pointerup",this.handleInput)}createUI(){this.buttons=[];const e=40,i=8,t=window.innerWidth-100,s=Math.floor(t/(e+i)),r=40,n=window.innerHeight-180;this.colors.forEach((o,a)=>{const h=a%s,f=Math.floor(a/s);this.buttons.push({color:o.hex,x:r+h*(e+i),y:n+f*(e+i),width:e,height:e,action:()=>{this.currentColor=o.rgb}})}),this.buttons.push({text:"Next Picture",x:window.innerWidth-180,y:window.innerHeight-80,width:160,height:50,action:()=>{this.currentImageIndex=(this.currentImageIndex+1)%this.images.length,this.resetImage()}}),this.buttons.push({text:"Save",x:window.innerWidth-300,y:window.innerHeight-80,width:100,height:50,action:()=>{const o=document.createElement("a");o.download="sara_masterpiece.png",o.href=this.bufferCanvas.toDataURL(),o.click()}}),this.buttons.push({text:"Back",x:window.innerWidth-100,y:20,width:80,height:40,action:()=>{this.sceneManager.switchScene(new p(this.sceneManager))}})}handleInput=e=>{const t=this.sceneManager.getCanvas().getBoundingClientRect(),s=Math.floor(e.clientX-t.left),r=Math.floor(e.clientY-t.top);for(const n of this.buttons)if(s>=n.x&&s<=n.x+n.width&&r>=n.y&&r<=n.y+n.height){n.action();return}this.floodFill(s,r,this.currentColor)};floodFill(e,i,t){const s=this.bufferCanvas.width,r=this.bufferCanvas.height,n=this.bufferCtx.getImageData(0,0,s,r),o=n.data,a=d=>({r:o[d],g:o[d+1],b:o[d+2],a:o[d+3]}),h=(d,u)=>Math.abs(d.r-u.r)<50&&Math.abs(d.g-u.g)<50&&Math.abs(d.b-u.b)<50,f=(i*s+e)*4,l=a(f);if(h(l,t)||l.r<50&&l.g<50&&l.b<50)return;const g=[[e,i]];for(;g.length;){const[d,u]=g.pop(),v=(u*s+d)*4;if(d<0||d>=s||u<0||u>=r)continue;const m=a(v);h(m,l)&&(o[v]=t.r,o[v+1]=t.g,o[v+2]=t.b,o[v+3]=255,g.push([d+1,u]),g.push([d-1,u]),g.push([d,u+1]),g.push([d,u-1]))}this.bufferCtx.putImageData(n,0,0)}update(e){}draw(e){e.drawImage(this.bufferCanvas,0,0),this.drawUI(e)}drawUI(e){e.font='bold 16px "Nunito"',e.textAlign="center",e.textBaseline="middle";for(const i of this.buttons){const t=i.color===this.rgbToHex(this.currentColor);e.fillStyle=i.color||"#ccc",t?(e.strokeStyle="#000",e.lineWidth=3):(e.strokeStyle="rgba(0,0,0,0.5)",e.lineWidth=1),e.beginPath(),e.roundRect?e.roundRect(i.x,i.y,i.width,i.height,10):e.rect(i.x,i.y,i.width,i.height),e.fill(),e.stroke(),i.text&&(e.fillStyle="black",e.fillText(i.text,i.x+i.width/2,i.y+i.height/2))}e.fillStyle="#333",e.font="30px 'Fredoka One'",e.textAlign="center",e.fillText("Magic Coloring",e.canvas.width/2,50)}rgbToHex(e){return"#"+((1<<24)+(e.r<<16)+(e.g<<8)+e.b).toString(16).slice(1)}onResize(e,i){this.bufferCanvas.width=e,this.bufferCanvas.height=i,this.resetImage(),this.createUI()}cleanup(){this.sceneManager.getCanvas().removeEventListener("pointerup",this.handleInput)}}const b=[[[1,1,1,1]],[[1,0,0],[1,1,1]],[[0,0,1],[1,1,1]],[[1,1],[1,1]],[[0,1,1],[1,1,0]],[[0,1,0],[1,1,1]],[[1,1,0],[0,1,1]]],k=["#00f0f0","#0000f0","#f0a000","#f0f000","#00f000","#a000f0","#f00000"];class L{sceneManager;grid;cols=10;rows=20;size=30;currentPiece=null;dropCounter=0;dropInterval=1e3;score=0;gameOver=!1;constructor(e){this.sceneManager=e,this.grid=Array.from({length:this.rows},()=>Array(this.cols).fill(null))}init(){this.reset(),window.addEventListener("keydown",this.handleInput),window.addEventListener("touchstart",this.handleTouch,{passive:!1}),window.addEventListener("pointerup",this.handleClick)}handleClick=e=>{const i=window.innerWidth;e.clientX>i-100&&e.clientY<80?this.sceneManager.switchScene(new p(this.sceneManager)):this.gameOver&&this.reset()};reset(){this.grid=Array.from({length:this.rows},()=>Array(this.cols).fill(null)),this.score=0,this.gameOver=!1,this.spawnPiece()}spawnPiece(){const e=Math.floor(Math.random()*b.length);this.currentPiece={shape:b[e],color:k[e],x:3,y:0},this.collide(this.grid,this.currentPiece)&&(this.gameOver=!0,this.currentPiece=null)}handleInput=e=>{if(this.gameOver){e.key==="Enter"&&this.reset(),e.key==="Escape"&&this.sceneManager.switchScene(new p(this.sceneManager));return}this.currentPiece&&(e.key==="ArrowLeft"?(this.currentPiece.x--,this.collide(this.grid,this.currentPiece)&&this.currentPiece.x++):e.key==="ArrowRight"?(this.currentPiece.x++,this.collide(this.grid,this.currentPiece)&&this.currentPiece.x--):e.key==="ArrowDown"?this.drop():e.key==="ArrowUp"&&this.rotate())};rotate(){if(!this.currentPiece)return;const e=this.currentPiece.shape,i=e[0].map((s,r)=>e.map(n=>n[r]).reverse()),t=this.currentPiece.shape;this.currentPiece.shape=i,this.collide(this.grid,this.currentPiece)&&(this.currentPiece.shape=t)}handleTouch=e=>{const i=e.touches[0].clientX,t=window.innerWidth;if(this.gameOver){this.reset();return}i<t*.3?this.currentPiece&&(this.currentPiece.x--,this.collide(this.grid,this.currentPiece)&&this.currentPiece.x++):i>t*.7?this.currentPiece&&(this.currentPiece.x++,this.collide(this.grid,this.currentPiece)&&this.currentPiece.x--):this.rotate()};collide(e,i){for(let t=0;t<i.shape.length;t++)for(let s=0;s<i.shape[t].length;s++)if(i.shape[t][s]!==0){const r=i.y+t,n=i.x+s;if(r>=this.rows||n<0||n>=this.cols||r>=0&&e[r][n])return!0}return!1}merge(e,i){for(let t=0;t<i.shape.length;t++)for(let s=0;s<i.shape[t].length;s++)if(i.shape[t][s]!==0){const r=i.y+t,n=i.x+s;r>=0&&r<this.rows&&n>=0&&n<this.cols&&(e[r][n]=i.color)}}arenaSweep(){let e=1;e:for(let i=this.rows-1;i>0;--i){for(let s=0;s<this.cols;++s)if(!this.grid[i][s])continue e;const t=this.grid.splice(i,1)[0].fill(null);this.grid.unshift(t),++i,this.score+=e*10,e*=2}w.getInstance().updateHighScore("tetris",this.score)}drop(){this.currentPiece&&(this.currentPiece.y++,this.collide(this.grid,this.currentPiece)&&(this.currentPiece.y--,this.merge(this.grid,this.currentPiece),this.spawnPiece(),this.arenaSweep()),this.dropCounter=0)}update(e){this.gameOver||(this.dropCounter+=e,this.dropCounter>this.dropInterval&&this.drop())}draw(e){e.fillStyle="#222",e.fillRect(0,0,e.canvas.width,e.canvas.height);const i=this.cols*this.size,t=this.rows*this.size,s=(e.canvas.width-i)/2,r=(e.canvas.height-t)/2;e.save(),e.translate(s,r),e.strokeStyle="#333",e.strokeRect(0,0,i,t);for(let n=0;n<this.rows;n++)for(let o=0;o<this.cols;o++)this.grid[n][o]&&this.drawBlock(e,o,n,this.grid[n][o]);if(this.currentPiece)for(let n=0;n<this.currentPiece.shape.length;n++)for(let o=0;o<this.currentPiece.shape[n].length;o++)this.currentPiece.shape[n][o]!==0&&this.drawBlock(e,this.currentPiece.x+o,this.currentPiece.y+n,this.currentPiece.color);e.restore(),e.fillStyle="white",e.font="24px 'Nunito'",e.textAlign="left",e.fillText(`Score: ${this.score}`,20,40),this.gameOver&&(e.fillStyle="rgba(0,0,0,0.8)",e.fillRect(0,0,e.canvas.width,e.canvas.height),e.fillStyle="white",e.textAlign="center",e.font="40px 'Fredoka One'",e.fillText("GAME OVER",e.canvas.width/2,e.canvas.height/2),e.font="20px 'Nunito'",e.fillText("Tap / Enter to Restart",e.canvas.width/2,e.canvas.height/2+40)),e.fillStyle="#95a5a6",e.fillRect(e.canvas.width-100,20,80,40),e.fillStyle="white",e.font='20px "Nunito"',e.textAlign="center",e.textBaseline="middle",e.fillText("Back",e.canvas.width-60,40)}drawBlock(e,i,t,s){e.fillStyle=s,e.fillRect(i*this.size,t*this.size,this.size-1,this.size-1),e.fillStyle="rgba(255,255,255,0.3)",e.fillRect(i*this.size,t*this.size,this.size-1,4)}onResize(e,i){this.size=Math.min(e/15,i/25)}cleanup(){window.removeEventListener("keydown",this.handleInput),window.removeEventListener("touchstart",this.handleTouch),window.removeEventListener("pointerup",this.handleClick)}}class S{static init(){}static drawCharacter(e,i,t,s,r){e.save(),e.translate(i,t),e.scale(s,s);const n=r.hairColor||"#ffffff",o=r.hairStyle%10;this.drawBackHair(e,o,n),this.drawBody(e),this.drawHead(e),this.drawFace(e),r.outfit%2===0?this.drawDress(e,r.outfitColor||"#ff9ff3"):this.drawShirtSkirt(e,r.outfitColor||"#ff9ff3"),this.drawFrontHair(e,o,n),r.pet&&this.drawPet(e,r.pet),e.restore()}static roundRect(e,i,t,s,r,n){e.roundRect?e.roundRect(i,t,s,r,n):e.rect(i,t,s,r)}static drawBody(e){e.fillStyle="#ffe0bd",e.fillRect(-8,30,16,15),e.beginPath(),this.roundRect(e,-38,45,12,45,6),this.roundRect(e,26,45,12,45,6),e.fill(),e.beginPath(),e.moveTo(-15,90),e.lineTo(-18,140),e.quadraticCurveTo(-10,145,-5,140),e.lineTo(-5,90),e.fill(),e.beginPath(),e.moveTo(15,90),e.lineTo(18,140),e.quadraticCurveTo(10,145,5,140),e.lineTo(5,90),e.fill(),e.beginPath(),this.roundRect(e,-25,40,50,60,10),e.fill()}static drawHead(e){e.fillStyle="#ffe0bd",e.beginPath(),e.moveTo(-48,-20),e.bezierCurveTo(-48,40,-25,65,0,65),e.bezierCurveTo(25,65,48,40,48,-20),e.bezierCurveTo(48,-75,-48,-75,-48,-20),e.fill()}static drawFace(e){e.fillStyle="rgba(255, 100, 100, 0.2)",e.beginPath(),e.ellipse(-30,25,12,7,0,0,Math.PI*2),e.fill(),e.beginPath(),e.ellipse(30,25,12,7,0,0,Math.PI*2),e.fill(),this.drawAnimeEye(e,-22,5,!1),this.drawAnimeEye(e,22,5,!0),e.strokeStyle="#b08d76",e.lineWidth=2.5,e.lineCap="round",e.beginPath(),e.moveTo(-35,-12),e.quadraticCurveTo(-22,-16,-10,-12),e.stroke(),e.beginPath(),e.moveTo(35,-12),e.quadraticCurveTo(22,-16,10,-12),e.stroke(),e.strokeStyle="#8a5a44",e.beginPath(),e.arc(0,30,5,.1,Math.PI-.1),e.stroke()}static drawAnimeEye(e,i,t,s){e.save(),e.translate(i,t),e.fillStyle="#fff",e.beginPath(),e.ellipse(0,0,14,18,0,0,Math.PI*2),e.fill();const r=e.createLinearGradient(0,-10,0,10);r.addColorStop(0,"#555"),r.addColorStop(1,"#222"),e.fillStyle=r,e.beginPath(),e.ellipse(0,3,10,12,0,0,Math.PI*2),e.fill(),e.fillStyle="#000",e.beginPath(),e.arc(0,5,4,0,Math.PI*2),e.fill(),e.fillStyle="#fff",e.beginPath(),e.arc(-5,-6,4.5,0,Math.PI*2),e.fill(),e.globalAlpha=.6,e.beginPath(),e.arc(4,6,2.5,0,Math.PI*2),e.fill(),e.globalAlpha=1,e.fillStyle="#2d3436",e.beginPath(),s?(e.moveTo(-14,-6),e.quadraticCurveTo(0,-18,16,-4),e.lineTo(18,-8),e.quadraticCurveTo(0,-24,-16,-8)):(e.moveTo(14,-6),e.quadraticCurveTo(0,-18,-16,-4),e.lineTo(-18,-8),e.quadraticCurveTo(0,-24,16,-8)),e.fill(),e.restore()}static drawDress(e,i){e.fillStyle=i,e.beginPath(),e.moveTo(-22,40),e.lineTo(22,40),e.lineTo(24,85),e.lineTo(-24,85),e.fill(),e.beginPath(),e.arc(-32,50,14,0,Math.PI*2),e.fill(),e.beginPath(),e.arc(32,50,14,0,Math.PI*2),e.fill(),e.beginPath(),e.moveTo(-24,85),e.quadraticCurveTo(-60,120,-55,145),e.quadraticCurveTo(0,160,55,145),e.quadraticCurveTo(60,120,24,85),e.fill(),e.fillStyle="#ff7675",e.beginPath(),e.arc(0,85,6,0,Math.PI*2),e.fill(),e.beginPath(),e.ellipse(-10,85,8,5,-.4,0,Math.PI*2),e.fill(),e.beginPath(),e.ellipse(10,85,8,5,.4,0,Math.PI*2),e.fill()}static drawShirtSkirt(e,i){e.fillStyle="#fff",e.fillRect(-24,40,48,50),e.beginPath(),e.ellipse(-32,50,12,10,.3,0,Math.PI*2),e.fill(),e.beginPath(),e.ellipse(32,50,12,10,-.3,0,Math.PI*2),e.fill(),e.fillStyle=i,e.beginPath(),e.moveTo(-24,90),e.lineTo(24,90),e.lineTo(45,135),e.lineTo(-45,135),e.fill(),e.strokeStyle="rgba(0,0,0,0.1)",e.lineWidth=2,e.beginPath(),e.moveTo(-10,90),e.lineTo(-15,135),e.stroke(),e.beginPath(),e.moveTo(10,90),e.lineTo(15,135),e.stroke()}static drawBackHair(e,i,t){e.fillStyle=t,e.beginPath(),i===0?(e.moveTo(-50,-20),e.bezierCurveTo(-75,40,-80,140,-20,160),e.quadraticCurveTo(0,150,20,160),e.bezierCurveTo(80,140,75,40,50,-20)):i===1?(e.arc(0,-20,52,Math.PI,0),e.lineTo(52,40),e.quadraticCurveTo(40,60,0,55),e.quadraticCurveTo(-40,60,-52,40),e.lineTo(-52,-20)):i===2?(e.moveTo(-45,-30),e.bezierCurveTo(-90,-10,-100,100,-80,130),e.quadraticCurveTo(-70,140,-60,110),e.bezierCurveTo(-50,60,-50,10,-45,-30),e.moveTo(45,-30),e.bezierCurveTo(90,-10,100,100,80,130),e.quadraticCurveTo(70,140,60,110),e.bezierCurveTo(50,60,50,10,45,-30)):i===3?e.arc(0,-50,30,0,Math.PI*2):i===4?(e.arc(0,-25,50,Math.PI,0),e.lineTo(48,10),e.quadraticCurveTo(0,25,-48,10),e.lineTo(-50,-25)):i===6?(e.arc(0,-25,60,Math.PI,0),e.bezierCurveTo(70,0,90,80,60,120),e.quadraticCurveTo(0,140,-60,120),e.bezierCurveTo(-90,80,-70,0,-60,-25)):i===8&&(e.moveTo(-40,0),e.lineTo(-50,80),e.quadraticCurveTo(-45,90,-40,80),e.lineTo(-30,0),e.moveTo(40,0),e.lineTo(50,80),e.quadraticCurveTo(45,90,40,80),e.lineTo(30,0)),i!==9&&e.fill()}static drawFrontHair(e,i,t){e.fillStyle=t,i!==9&&(i!==7&&(e.beginPath(),e.arc(0,-25,50,Math.PI,0),e.fill()),e.beginPath(),i===7?(e.moveTo(-50,-20),e.lineTo(-30,-60),e.lineTo(-10,-30),e.lineTo(10,-70),e.lineTo(30,-30),e.lineTo(50,-50),e.lineTo(50,0),e.quadraticCurveTo(0,-10,-50,0)):i===3||i===4?(e.moveTo(-50,-25),e.quadraticCurveTo(0,-40,50,-25),e.lineTo(50,-5),e.quadraticCurveTo(0,-15,-50,-5)):(e.moveTo(-52,-30),e.bezierCurveTo(-50,-85,50,-85,52,-30),e.lineTo(52,-5),e.quadraticCurveTo(40,-15,35,0),e.quadraticCurveTo(25,-20,15,0),e.quadraticCurveTo(5,-20,0,-5),e.quadraticCurveTo(-5,-20,-15,0),e.quadraticCurveTo(-25,-20,-35,0),e.quadraticCurveTo(-40,-15,-52,-5)),e.closePath(),e.fill(),i===2?(e.fillStyle="#ff7675",e.beginPath(),e.arc(-50,-25,6,0,Math.PI*2),e.fill(),e.beginPath(),e.arc(50,-25,6,0,Math.PI*2),e.fill()):i===3?(e.fillStyle="#ff7675",e.beginPath(),e.rect(-10,-55,20,10),e.fill()):i===5&&(e.fillStyle=t,e.beginPath(),e.ellipse(45,10,15,40,.4,0,Math.PI*2),e.fill(),e.fillStyle="#fab1a0",e.beginPath(),e.arc(38,-10,6,0,Math.PI*2),e.fill()))}static drawPet(e,i){e.save(),e.translate(70,90);const t=.7;e.scale(t,t),i==="cat"?(e.fillStyle="#fdb",e.beginPath(),e.arc(0,0,18,0,Math.PI*2),e.fill(),e.fillStyle="#000",e.beginPath(),e.arc(-6,-2,2.5,0,Math.PI*2),e.arc(6,-2,2.5,0,Math.PI*2),e.fill(),e.beginPath(),e.moveTo(-12,-12),e.lineTo(-18,-30),e.lineTo(-6,-14),e.fill(),e.beginPath(),e.moveTo(12,-12),e.lineTo(18,-30),e.lineTo(6,-14),e.fill(),e.fillStyle="pink",e.beginPath(),e.ellipse(0,2,3,2,0,0,Math.PI*2),e.fill()):i==="dog"?(e.fillStyle="#dfe6e9",e.beginPath(),e.arc(0,0,20,0,Math.PI*2),e.fill(),e.fillStyle="#2d3436",e.beginPath(),e.ellipse(-15,2,8,16,.4,0,Math.PI*2),e.fill(),e.beginPath(),e.ellipse(15,2,8,16,-.4,0,Math.PI*2),e.fill(),e.fillStyle="black",e.beginPath(),e.arc(-6,-3,2.5,0,Math.PI*2),e.arc(6,-3,2.5,0,Math.PI*2),e.fill(),e.beginPath(),e.ellipse(0,4,5,3,0,0,Math.PI*2),e.fill()):i==="dragon"&&(e.fillStyle="#fdcb6e",e.beginPath(),e.moveTo(-20,20),e.lineTo(20,20),e.lineTo(0,-25),e.fill(),e.fillStyle="#55efc4",e.beginPath(),e.ellipse(-14,-8,18,10,-.4,0,Math.PI*2),e.fill(),e.beginPath(),e.ellipse(14,-8,18,10,.4,0,Math.PI*2),e.fill(),e.fillStyle="black",e.beginPath(),e.arc(-5,-6,2.5,0,Math.PI*2),e.arc(5,-6,2.5,0,Math.PI*2),e.fill()),e.restore()}}class R{sceneManager;playerX=1;playerY=1;tileSize=40;currentLevelIndex=0;isDragging=!1;lastMoveTime=0;levels=[[[0,0,0,0,0,0,0,0,0,0,0,0],[0,2,1,1,0,1,1,1,1,1,1,0],[0,0,0,1,0,1,0,0,0,0,1,0],[0,1,1,1,1,1,1,0,1,1,1,0],[0,1,0,0,0,0,1,0,0,0,1,0],[0,1,1,1,0,1,1,1,0,3,1,0],[0,0,0,0,0,0,0,0,0,0,0,0]],[[0,0,0,0,0,0,0,0,0,0,0,0,0],[0,2,1,1,1,1,0,1,1,1,1,1,0],[0,0,0,0,0,1,0,1,0,0,0,1,0],[0,1,1,1,0,1,0,1,1,1,0,1,0],[0,1,0,1,0,1,1,1,0,1,0,1,0],[0,1,0,0,0,0,0,0,0,1,0,1,0],[0,1,1,1,1,1,1,1,1,1,0,3,0],[0,0,0,0,0,0,0,0,0,0,0,0,0]],[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,2,1,0,1,1,1,1,0,1,1,1,1,1,0],[0,1,0,0,1,0,0,1,0,0,0,0,0,1,0],[0,1,1,1,1,0,1,1,1,1,1,1,0,1,0],[0,0,0,0,1,0,0,0,0,0,0,1,0,1,0],[0,1,1,1,1,1,1,1,1,1,0,1,0,1,0],[0,1,0,0,0,0,0,0,0,1,0,1,0,1,0],[0,1,1,1,0,1,1,1,1,1,1,1,0,3,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]]];currentLevel;constructor(e){this.sceneManager=e,this.currentLevel=this.levels[0],this.findStart()}findStart(){for(let e=0;e<this.currentLevel.length;e++)for(let i=0;i<this.currentLevel[e].length;i++)if(this.currentLevel[e][i]===2){this.playerX=i,this.playerY=e;return}}init(){console.log("DEBUG: MazeScene Init (Rewritten)"),window.addEventListener("keydown",this.handleInput),window.addEventListener("mousedown",this.handleStart),window.addEventListener("mousemove",this.handleMove),window.addEventListener("mouseup",this.handleEnd),window.addEventListener("touchstart",this.handleStart,{passive:!1}),window.addEventListener("touchmove",this.handleMove,{passive:!1}),window.addEventListener("touchend",this.handleEnd)}handleStart=e=>{let i,t;if(e instanceof MouseEvent?(i=e.clientX,t=e.clientY):(i=e.touches[0].clientX,t=e.touches[0].clientY),i>window.innerWidth-100&&t<80){this.sceneManager.switchScene(new p(this.sceneManager));return}const{offsetX:s,offsetY:r}=this.getOffsets(),n=s+this.playerX*this.tileSize,o=r+this.playerY*this.tileSize;i>=n-10&&i<=n+this.tileSize+10&&t>=o-10&&t<=o+this.tileSize+10&&(this.isDragging=!0),e.type==="touchstart"&&e.preventDefault()};handleMove=e=>{if(!this.isDragging)return;let i,t;e instanceof MouseEvent?(i=e.clientX,t=e.clientY):(i=e.touches[0].clientX,t=e.touches[0].clientY),e.type==="touchmove"&&e.preventDefault();const{offsetX:s,offsetY:r}=this.getOffsets(),n=Math.floor((i-s)/this.tileSize),o=Math.floor((t-r)/this.tileSize),a=n-this.playerX,h=o-this.playerY;Math.abs(a)+Math.abs(h)===1&&this.attemptMove(a,h)};handleEnd=()=>{this.isDragging=!1};handleInput=e=>{let i=0,t=0;e.key==="ArrowUp"&&(t=-1),e.key==="ArrowDown"&&(t=1),e.key==="ArrowLeft"&&(i=-1),e.key==="ArrowRight"&&(i=1),this.attemptMove(i,t)};attemptMove(e,i){const t=Date.now();if(t-this.lastMoveTime<100)return;const s=this.playerX+e,r=this.playerY+i;r>=0&&r<this.currentLevel.length&&s>=0&&s<this.currentLevel[r].length&&this.currentLevel[r][s]!==0&&(this.playerX=s,this.playerY=r,this.lastMoveTime=t,this.currentLevel[r][s]===3&&this.nextLevel())}nextLevel(){this.currentLevelIndex++,this.currentLevelIndex<this.levels.length?(this.currentLevel=this.levels[this.currentLevelIndex],this.findStart(),this.isDragging=!1):this.sceneManager.switchScene(new p(this.sceneManager))}getOffsets(){const e=(window.innerWidth-this.currentLevel[0].length*this.tileSize)/2,i=(window.innerHeight-this.currentLevel.length*this.tileSize)/2;return{offsetX:e,offsetY:i}}update(e){}draw(e){const i=e.canvas.width,t=e.canvas.height;e.fillStyle="#2c3e50",e.fillRect(0,0,i,t);const{offsetX:s,offsetY:r}=this.getOffsets();for(let a=0;a<this.currentLevel.length;a++)for(let h=0;h<this.currentLevel[a].length;h++){const f=this.currentLevel[a][h],l=s+h*this.tileSize,g=r+a*this.tileSize;f===0?(e.fillStyle="#34495e",e.fillRect(l,g,this.tileSize,this.tileSize)):(e.fillStyle="#ecf0f1",e.fillRect(l,g,this.tileSize,this.tileSize),f===3&&(e.fillStyle="#e74c3c",e.fillRect(l+10,g+10,this.tileSize-20,this.tileSize-20)))}const n=s+this.playerX*this.tileSize+this.tileSize/2,o=r+this.playerY*this.tileSize+this.tileSize/2;this.isDragging&&(e.beginPath(),e.arc(n,o,30,0,Math.PI*2),e.fillStyle="rgba(255, 234, 167, 0.4)",e.fill()),S.drawCharacter(e,n,o,.4,w.getInstance().character),e.fillStyle="white",e.font='20px "Nunito"',e.textAlign="left",e.fillText(`Level ${this.currentLevelIndex+1}`,20,40),e.fillText("Click & Hold Sara to Move!",20,70),e.fillStyle="#95a5a6",e.fillRect(i-100,20,80,40),e.fillStyle="white",e.fillText("Back",i-60,45)}onResize(e,i){}cleanup(){window.removeEventListener("keydown",this.handleInput),window.removeEventListener("mousedown",this.handleStart),window.removeEventListener("mousemove",this.handleMove),window.removeEventListener("mouseup",this.handleEnd),window.removeEventListener("touchstart",this.handleStart),window.removeEventListener("touchmove",this.handleMove),window.removeEventListener("touchend",this.handleEnd)}}class E{sceneManager;tiles=[];gridSize=3;tileSize=100;solved=!1;constructor(e){this.sceneManager=e}init(){this.resetPuzzle(),window.addEventListener("click",this.handleClick.bind(this))}resetPuzzle(){this.tiles=[0,1,2,3,4,5,6,7,8];for(let e=0;e<20;e++)this.randomMove();this.solved=!1}randomMove(){const e=this.tiles.indexOf(8),i=this.getNeighbors(e),t=i[Math.floor(Math.random()*i.length)];this.swap(e,t)}getNeighbors(e){const i=[],t=e%this.gridSize,s=Math.floor(e/this.gridSize);return t>0&&i.push(e-1),t<this.gridSize-1&&i.push(e+1),s>0&&i.push(e-this.gridSize),s<this.gridSize-1&&i.push(e+this.gridSize),i}handleClick(e){if(e.clientX>window.innerWidth-100&&e.clientY<80){this.sceneManager.switchScene(new p(this.sceneManager));return}if(this.solved){this.resetPuzzle();return}const i=window.innerWidth/2,t=window.innerHeight/2,s=i-this.gridSize*this.tileSize/2,r=t-this.gridSize*this.tileSize/2,n=e.clientX-s,o=e.clientY-r;if(n>=0&&n<this.gridSize*this.tileSize&&o>=0&&o<this.gridSize*this.tileSize){const a=Math.floor(n/this.tileSize),f=Math.floor(o/this.tileSize)*this.gridSize+a;this.tryMove(f),this.checkWin()}}tryMove(e){const i=this.tiles.indexOf(8);this.getNeighbors(i).includes(e)&&this.swap(e,i)}swap(e,i){const t=this.tiles[e];this.tiles[e]=this.tiles[i],this.tiles[i]=t}checkWin(){for(let e=0;e<this.tiles.length;e++)if(this.tiles[e]!==e)return;this.solved=!0}update(e){}draw(e){e.fillStyle="#9b59b6",e.fillRect(0,0,e.canvas.width,e.canvas.height);const i=e.canvas.width/2,t=e.canvas.height/2,s=i-this.gridSize*this.tileSize/2,r=t-this.gridSize*this.tileSize/2;e.font='bold 30px "Fredoka One"',e.textAlign="center",e.fillStyle="white",e.fillText("Picture Puzzle",i,50),this.solved&&e.fillText("SOLVED! Click to Shuffle",i,t+200);for(let n=0;n<this.tiles.length;n++){const o=this.tiles[n];if(o===8&&!this.solved)continue;const a=n%this.gridSize,h=Math.floor(n/this.gridSize),f=s+a*this.tileSize,l=r+h*this.tileSize;e.fillStyle="#ecf0f1",e.fillRect(f+2,l+2,this.tileSize-4,this.tileSize-4),e.fillStyle="#2c3e50",e.fillText((o+1).toString(),f+this.tileSize/2,l+this.tileSize/2+10)}e.font='20px "Nunito"',e.textAlign="center",e.fillStyle="#95a5a6",e.fillRect(e.canvas.width-100,20,80,40),e.fillStyle="white",e.fillText("Back",e.canvas.width-60,45)}onResize(e,i){}cleanup(){window.removeEventListener("click",this.handleClick.bind(this))}}class z{sceneManager;isRunning=!1;score=0;speed=6;gameTime=0;highScore=0;horseY=0;velocityY=0;gravity=.6;jumpForce=-13;isGrounded=!0;groundY=0;obstacles=[];clouds=[];mountains=[];spawnTimer=0;constructor(e){this.sceneManager=e,this.highScore=Number(localStorage.getItem("sara_runner_highscore"))||0}init(){this.onResize(window.innerWidth,window.innerHeight),this.resetGame(),this.initBackground(),window.addEventListener("keydown",this.handleInput),window.addEventListener("mousedown",this.handleJump),window.addEventListener("touchstart",this.handleJump,{passive:!1})}initBackground(){for(let i=0;i<5;i++)this.clouds.push({x:Math.random()*window.innerWidth,y:Math.random()*(window.innerHeight/2),size:30+Math.random()*40,speed:.5+Math.random()*.5});let e=0;for(;e<window.innerWidth+200;)this.mountains.push({x:e,height:100+Math.random()*150}),e+=80+Math.random()*100}resetGame(){this.isRunning=!0,this.score=0,this.speed=7,this.horseY=this.groundY,this.velocityY=0,this.obstacles=[],this.gameTime=0}handleInput=e=>{(e.code==="Space"||e.key==="ArrowUp")&&this.isRunning?this.handleJump():!this.isRunning&&this.gameTime>10&&this.resetGame()};handleJump=e=>{if(e){let i,t;if(e instanceof MouseEvent?(i=e.clientX,t=e.clientY):(i=e.touches[0].clientX,t=e.touches[0].clientY),i>window.innerWidth-100&&t<80){this.sceneManager.switchScene(new p(this.sceneManager));return}e.type==="touchstart"&&e.preventDefault()}this.isRunning&&this.isGrounded?(this.velocityY=this.jumpForce,this.isGrounded=!1):!this.isRunning&&this.gameTime>10&&this.resetGame()};handleTouch=e=>{this.handleJump(e)};handleClick=e=>{this.handleJump(e)};update(e){if(this.gameTime++,this.clouds.forEach(i=>{i.x-=i.speed,i.x<-100&&(i.x=window.innerWidth+100)}),!!this.isRunning){if(this.score++,this.speed+=.0015,this.score>this.highScore&&(this.highScore=this.score,localStorage.setItem("sara_runner_highscore",this.highScore.toString())),this.velocityY+=this.gravity,this.horseY+=this.velocityY,this.horseY>=this.groundY&&(this.horseY=this.groundY,this.velocityY=0,this.isGrounded=!0),this.mountains.forEach(i=>{i.x-=this.speed*.2,i.x<-200&&(i.x+=window.innerWidth+400)}),this.spawnTimer++,this.spawnTimer>90+Math.random()*50){const i=Math.random()>.5?"rock":"bush";this.obstacles.push({x:window.innerWidth,y:this.groundY+10,width:50,height:50,type:i}),this.spawnTimer=0}for(let i=this.obstacles.length-1;i>=0;i--){let t=this.obstacles[i];t.x-=this.speed,t.x<-100&&this.obstacles.splice(i,1),150>t.x+10&&110<t.x+t.width-10&&this.horseY+50>t.y+10&&(this.isRunning=!1)}}}draw(e){const i=e.canvas.width,t=e.canvas.height,s=e.createLinearGradient(0,0,0,t);s.addColorStop(0,"#87CEEB"),s.addColorStop(1,"#E0F7FA"),e.fillStyle=s,e.fillRect(0,0,i,t),e.fillStyle="#6c5ce7",e.beginPath(),this.mountains.forEach(n=>{e.moveTo(n.x,t-80),e.lineTo(n.x+100,t-80-n.height),e.lineTo(n.x+200,t-80)}),e.fill(),e.fillStyle="rgba(255, 255, 255, 0.8)",this.clouds.forEach(n=>{this.drawCloud(e,n.x,n.y,n.size)}),e.fillStyle="#2ecc71",e.fillRect(0,this.groundY+40,i,t-(this.groundY+40)),e.fillStyle="#27ae60",e.fillRect(0,this.groundY+40,i,10);const r=this.isRunning&&this.isGrounded?Math.floor(this.gameTime/5)%2:2;this.drawHorse(e,100,this.horseY,r),this.obstacles.forEach(n=>{n.type==="rock"?this.drawRock(e,n.x,n.y):this.drawBush(e,n.x,n.y)}),e.fillStyle="white",e.font='bold 30px "Fredoka One"',e.textAlign="left",e.lineWidth=3,e.strokeText(`Score: ${Math.floor(this.score/10)}`,20,50),e.fillText(`Score: ${Math.floor(this.score/10)}`,20,50),e.font='20px "Nunito"',e.fillText(`High: ${Math.floor(this.highScore/10)}`,20,80),this.isRunning||(e.fillStyle="rgba(0,0,0,0.5)",e.fillRect(0,0,i,t),e.fillStyle="white",e.textAlign="center",e.font='bold 40px "Fredoka One"',e.fillText("GAME OVER",i/2,t/2-20),e.font='24px "Nunito"',e.fillText("Tap to Run Again",i/2,t/2+30)),this.drawBackButton(e)}drawBackButton(e){const i=e.canvas.width;e.fillStyle="#95a5a6",this.roundRect(e,i-110,20,90,40,10),e.fillStyle="white",e.font='bold 20px "Nunito"',e.textAlign="center",e.fillText("Back",i-65,47)}drawCloud(e,i,t,s){e.beginPath(),e.arc(i,t,s,0,Math.PI*2),e.arc(i+s*.8,t+s*.2,s*.7,0,Math.PI*2),e.arc(i-s*.8,t+s*.2,s*.7,0,Math.PI*2),e.fill()}drawHorse(e,i,t,s){e.save(),e.translate(i,t);const r=.8;e.scale(r,r),e.fillStyle="#e67e22",e.beginPath(),e.ellipse(30,30,25,15,0,0,Math.PI*2),e.fill(),e.beginPath(),e.moveTo(45,25),e.lineTo(65,5),e.lineTo(75,15),e.lineTo(65,30),e.fill(),e.fillStyle="#d35400",e.beginPath(),e.moveTo(50,15),e.lineTo(60,0),e.lineTo(65,15),e.fill(),e.strokeStyle="#e67e22",e.lineWidth=6,e.lineCap="round",e.beginPath(),s===0?(e.moveTo(20,40),e.lineTo(10,60),e.moveTo(50,40),e.lineTo(60,60)):s===1?(e.moveTo(20,40),e.lineTo(30,60),e.moveTo(50,40),e.lineTo(40,60)):(e.moveTo(20,40),e.lineTo(5,50),e.moveTo(50,40),e.lineTo(70,45)),e.stroke(),e.strokeStyle="#d35400",e.beginPath(),e.moveTo(5,30),e.quadraticCurveTo(-10,20,-15,40),e.stroke(),e.restore()}drawRock(e,i,t){e.fillStyle="#7f8c8d",e.beginPath(),e.moveTo(i,t+40),e.lineTo(i+10,t+10),e.lineTo(i+30,t+0),e.lineTo(i+50,t+40),e.closePath(),e.fill(),e.fillStyle="#95a5a6",e.beginPath(),e.moveTo(i+10,t+15),e.lineTo(i+15,t+15),e.lineTo(i+12,t+30),e.fill()}drawBush(e,i,t){e.fillStyle="#27ae60",e.beginPath(),e.arc(i+15,t+30,15,0,Math.PI*2),e.arc(i+35,t+30,15,0,Math.PI*2),e.arc(i+25,t+15,18,0,Math.PI*2),e.fill()}roundRect(e,i,t,s,r,n){e.roundRect?e.roundRect(i,t,s,r,n):e.rect(i,t,s,r),e.fill()}onResize(e,i){this.groundY=i-120}cleanup(){window.removeEventListener("keydown",this.handleInput),window.removeEventListener("mousedown",this.handleJump),window.removeEventListener("touchstart",this.handleJump)}}class Y{sceneManager;cards=[];flippedCards=[];isLocked=!1;level=1;message="";showMessageTime=0;emojis=["ðŸ¦„","ðŸŒˆ","ðŸ¦","ðŸ­","ðŸ±","ðŸ¶","ðŸ¦‹","ðŸŒ¸","ðŸ“","ðŸ„","ðŸ¢","ðŸ¬","ðŸŽ€","ðŸ§¸","ðŸ£","ðŸŸ","ðŸ©","ðŸª","ðŸŽˆ","ðŸ°","ðŸ§œâ€â™€ï¸","ðŸ§šâ€â™€ï¸","ðŸ‘‘","ðŸ’Ž"];constructor(e){this.sceneManager=e}init(){this.startLevel(this.level),this.sceneManager.getCanvas().addEventListener("pointerup",this.handleInput)}startLevel(e){this.level=e,this.cards=[],this.flippedCards=[],this.isLocked=!1,this.message=`Level ${e}`,this.showMessageTime=120;let i=4,t=3;switch(e){case 1:i=4,t=3;break;case 2:i=4,t=4;break;case 3:i=5,t=4;break;case 4:i=6,t=4;break;case 5:i=6,t=5;break;default:i=6,t=5;break}const s=i*t/2,n=[...this.emojis].sort(()=>Math.random()-.5).slice(0,s),o=[...n,...n];o.sort(()=>Math.random()-.5);const a=this.sceneManager.getCanvas(),h=80,f=100,l=15,g=i*h+(i-1)*l,d=t*f+(t-1)*l,u=(a.width-g)/2,v=(a.height-d)/2+30;for(let m=0;m<o.length;m++){const M=m%i,T=Math.floor(m/i);this.cards.push({id:m,emoji:o[m],x:u+M*(h+l),y:v+T*(f+l),width:h,height:f,isFlipped:!1,isMatched:!1})}}handleInput=e=>{if(this.isLocked||this.showMessageTime>0)return;const i=this.sceneManager.getCanvas(),t=i.getBoundingClientRect(),s=i.width/t.width,r=i.height/t.height,n=(e.clientX-t.left)*s,o=(e.clientY-t.top)*r;if(n<100&&o<60){this.cleanup(),this.sceneManager.switchScene(new p(this.sceneManager));return}for(const a of this.cards)if(!a.isFlipped&&!a.isMatched&&n>=a.x&&n<=a.x+a.width&&o>=a.y&&o<=a.y+a.height){this.flipCard(a);break}};flipCard(e){e.isFlipped=!0,this.flippedCards.push(e),this.flippedCards.length===2&&(this.isLocked=!0,this.checkMatch())}checkMatch(){const[e,i]=this.flippedCards;e.emoji===i.emoji?(e.isMatched=!0,i.isMatched=!0,this.flippedCards=[],this.isLocked=!1,this.message="Good Job! âœ¨",this.showMessageTime=30,this.cards.every(t=>t.isMatched)&&setTimeout(()=>{this.message="Level Complete! ðŸŽ‰",this.showMessageTime=120,setTimeout(()=>this.startLevel(this.level+1),2e3)},500)):setTimeout(()=>{e.isFlipped=!1,i.isFlipped=!1,this.flippedCards=[],this.isLocked=!1},1e3)}update(e){this.showMessageTime>0&&this.showMessageTime--}draw(e){const i=e.canvas.width,t=e.canvas.height;e.fillStyle="#ffeaa7",e.fillRect(0,0,i,t),e.fillStyle="#ff7675",e.font="bold 40px 'Fredoka One'",e.textAlign="center",e.fillText(`Memory Magic - Level ${this.level}`,i/2,60),e.fillStyle="#fab1a0",e.beginPath(),e.roundRect(10,10,90,40,10),e.fill(),e.fillStyle="white",e.font="20px 'Nunito'",e.fillText("Back",55,36);for(const s of this.cards)this.drawCard(e,s);this.showMessageTime>0&&this.message&&(e.fillStyle="rgba(255, 255, 255, 0.8)",e.fillRect(0,t/2-50,i,100),e.fillStyle="#d63031",e.font="bold 50px 'Fredoka One'",e.fillText(this.message,i/2,t/2+15))}drawCard(e,i){e.save(),i.isFlipped||i.isMatched?e.fillStyle="white":e.fillStyle="#ff9ff3",e.shadowColor="rgba(0,0,0,0.2)",e.shadowBlur=5,e.shadowOffsetY=3,e.beginPath(),e.roundRect(i.x,i.y,i.width,i.height,10),e.fill(),e.restore(),i.isFlipped||i.isMatched?(e.font="50px serif",e.textAlign="center",e.textBaseline="middle",e.fillText(i.emoji,i.x+i.width/2,i.y+i.height/2+5)):(e.font="40px 'Fredoka One'",e.fillStyle="white",e.textAlign="center",e.textBaseline="middle",e.fillText("?",i.x+i.width/2,i.y+i.height/2))}onResize(e,i){this.startLevel(this.level)}cleanup(){this.sceneManager.getCanvas().removeEventListener("pointerup",this.handleInput)}}class p{sceneManager;buttons=[];constructor(e){this.sceneManager=e}init(){this.createUI(),this.sceneManager.getCanvas().addEventListener("pointerup",this.handleInput)}createUI(){this.buttons=[];const e=window.innerWidth,i=window.innerHeight,t=e/2,s=i/2,r=220,n=120,o=40,a=t-(r*1.5+o),h=s-(n+o/2);[{name:"Block Party",color:"#e74c3c",scene:()=>new L(this.sceneManager)},{name:"Creative Studio",color:"#f39c12",scene:()=>new P(this.sceneManager)},{name:"Coloring Book",color:"#f1c40f",scene:()=>new I(this.sceneManager)},{name:"Crystal Maze",color:"#1abc9c",scene:()=>new R(this.sceneManager)},{name:"Picture Puzzle",color:"#9b59b6",scene:()=>new E(this.sceneManager)},{name:"Horse Runner",color:"#3498db",scene:()=>new z(this.sceneManager)},{name:"Memory Magic",color:"#ff9ff3",scene:()=>new Y(this.sceneManager)}].forEach((l,g)=>{const d=g%3,u=Math.floor(g/3);this.buttons.push({text:l.name,x:a+d*(r+o),y:h+u*(n+o),width:r,height:n,color:l.color,action:()=>{this.sceneManager.switchScene(l.scene())}})}),this.buttons.push({text:"Change Hero",x:20,y:20,width:140,height:40,color:"#95a5a6",action:()=>{this.sceneManager.switchScene(new y(this.sceneManager))}})}handleInput=e=>{const i=this.sceneManager.getCanvas(),t=i.getBoundingClientRect(),s=i.width/t.width,r=i.height/t.height,n=(e.clientX-t.left)*s,o=(e.clientY-t.top)*r;console.log(`Input: client(${e.clientX}, ${e.clientY}) -> canvas(${n.toFixed(0)}, ${o.toFixed(0)})`);for(const a of this.buttons)if(n>=a.x&&n<=a.x+a.width&&o>=a.y&&o<=a.y+a.height){console.log(`Action: Clicked '${a.text}'`),a.action();break}};update(e){}draw(e){e.fillStyle="#fce4ec",e.fillRect(0,0,e.canvas.width,e.canvas.height),e.fillStyle="#ff6b81",e.font="bold 50px 'Fredoka One'",e.textAlign="center",e.fillText("Game Center",e.canvas.width/2,80),e.font="bold 24px 'Nunito'",e.textBaseline="middle";for(const i of this.buttons)e.fillStyle="rgba(0,0,0,0.1)",e.beginPath(),e.roundRect(i.x+5,i.y+5,i.width,i.height,15),e.fill(),e.fillStyle=i.color,e.beginPath(),e.roundRect(i.x,i.y,i.width,i.height,15),e.fill(),e.fillStyle="white",e.fillText(i.text,i.x+i.width/2,i.y+i.height/2)}onResize(e,i){this.createUI()}cleanup(){this.sceneManager.getCanvas().removeEventListener("pointerup",this.handleInput)}}class _{sceneManager;buttons=[];lastClick=0;bgImage;constructor(e){this.sceneManager=e,this.bgImage=new Image,this.bgImage.src=new URL("/sara_game/assets/dressing_room_bg-DnjJd2gh.png",import.meta.url).href}hairColors=["#2c3e50","#e74c3c","#f1c40f","#ecf0f1","#9b59b6","#e67e22","#3498db","#2ecc71","#34495e","#ff9ff3","#5f27cd","#00d2d3"];outfitColors=["#ff6b81","#a4b0be","#7bed9f","#eccc68","#ff7f50","#70a1ff","#5352ed","#ff4757","#2f3542","#d63031","#e056fd","#686de0"];pets=[null,"cat","dog","dragon"];init(){this.createUI(),this.sceneManager.getCanvas().addEventListener("pointerup",this.handleInput)}createUI(){this.buttons=[];const e=window.innerWidth/2,i=window.innerHeight/2,t=w.getInstance(),s=200,r=50;this.buttons.push({text:"Hair Style >",x:e-350,y:i-150,width:s,height:r,action:()=>{t.character.hairStyle=(t.character.hairStyle+1)%10}}),this.buttons.push({text:"Hair Color >",x:e-350,y:i-70,width:s,height:r,action:()=>{const n=this.hairColors.indexOf(t.character.hairColor);t.character.hairColor=this.hairColors[(n+1)%this.hairColors.length]}}),this.buttons.push({text:"Your Name",x:e-350,y:i+10,width:s,height:r,action:()=>{const n=prompt("Enter your name:",t.playerName);n&&(t.playerName=n)}}),this.buttons.push({text:"Outfit >",x:e+150,y:i-150,width:s,height:r,action:()=>{t.character.outfit=(t.character.outfit+1)%8}}),this.buttons.push({text:"Outfit Color >",x:e+150,y:i-70,width:s,height:r,action:()=>{const n=this.outfitColors.indexOf(t.character.outfitColor);t.character.outfitColor=this.outfitColors[(n+1)%this.outfitColors.length]}}),this.buttons.push({text:"Pet >",x:e+150,y:i+10,width:s,height:r,action:()=>{const n=this.pets.indexOf(t.character.pet);t.character.pet=this.pets[(n+1)%this.pets.length]}}),this.buttons.push({text:"COME OUT AND PLAY!",x:e-150,y:window.innerHeight-100,width:300,height:70,color:"#2ecc71",action:()=>{t.save(),this.sceneManager.switchScene(new p(this.sceneManager))}}),this.buttons.push({text:"MAKE IT BEAUTIFUL!",x:e-150,y:100,width:300,height:50,color:"#ff9a9e",action:()=>{t.character.hairStyle=Math.floor(Math.random()*10),t.character.outfit=Math.floor(Math.random()*2),t.character.hairColor=this.hairColors[Math.floor(Math.random()*this.hairColors.length)],t.character.outfitColor=this.outfitColors[Math.floor(Math.random()*this.outfitColors.length)],t.character.pet=this.pets[Math.floor(Math.random()*this.pets.length)]}})}handleInput=e=>{const i=Date.now();if(this.lastClick&&i-this.lastClick<300)return;this.lastClick=i;const t=this.sceneManager.getCanvas(),s=t.getBoundingClientRect(),r=t.width/s.width,n=t.height/s.height,o=(e.clientX-s.left)*r,a=(e.clientY-s.top)*n;console.log(`Creator Input: ${o.toFixed(0)}, ${a.toFixed(0)}`);for(const h of this.buttons)if(o>=h.x&&o<=h.x+h.width&&a>=h.y&&a<=h.y+h.height){h.action();return}};update(e){}draw(e){const i=e.canvas.width/2,t=e.canvas.height/2;this.bgImage.complete&&this.bgImage.naturalWidth>0?e.drawImage(this.bgImage,0,0,e.canvas.width,e.canvas.height):(e.fillStyle="#f0f8ff",e.fillRect(0,0,e.canvas.width,e.canvas.height)),e.fillStyle="rgba(255, 255, 255, 0.5)",e.beginPath(),e.arc(i,t,220,0,Math.PI*2),e.fill(),S.drawCharacter(e,i,t,2,w.getInstance().character),e.textAlign="center",e.textBaseline="middle",e.font='bold 20px "Nunito"';for(const s of this.buttons)e.fillStyle=s.color||"#ccc",e.beginPath(),e.rect(s.x,s.y,s.width,s.height),e.fill(),e.fillStyle="white",e.fillText(s.text,s.x+s.width/2,s.y+s.height/2);e.fillStyle="#555",e.font='bold 36px "Fredoka One"',e.fillText("Design Your Style",i,60)}onResize(e,i){this.createUI()}cleanup(){this.sceneManager.getCanvas().removeEventListener("pointerup",this.handleInput)}}class y{sceneManager;buttons=[];constructor(e){this.sceneManager=e}init(){console.log("DEBUG: TitleScene Init"),this.createUI(),this.sceneManager.getCanvas().addEventListener("pointerup",this.handleInput)}handleInput=e=>{const t=this.sceneManager.getCanvas().getBoundingClientRect(),s=e.clientX-t.left,r=e.clientY-t.top;for(const n of this.buttons)s>=n.x&&s<=n.x+n.width&&r>=n.y&&r<=n.y+n.height&&n.action()};createUI(){this.buttons=[];const e=window.innerWidth,i=window.innerHeight,t=200,s=300,r=50,n=(e-(3*t+2*r))/2,o=i/2-s/2,a=["sara","lara","sofia"],h=["#ff9a9e","#a18cd1","#4facfe"];a.forEach((f,l)=>{this.buttons.push({text:f.charAt(0).toUpperCase()+f.slice(1),x:n+l*(t+r),y:o,width:t,height:s,color:h[l],action:()=>{w.getInstance().currentSlot=f,w.getInstance().load(),this.sceneManager.switchScene(new _(this.sceneManager))}})})}update(e){}draw(e){const i=e.createLinearGradient(0,0,0,e.canvas.height);i.addColorStop(0,"#a18cd1"),i.addColorStop(1,"#fbc2eb"),e.fillStyle=i,e.fillRect(0,0,e.canvas.width,e.canvas.height),e.fillStyle="white",e.font='bold 60px "Fredoka One"',e.textAlign="center",e.fillText("Who are you today?",e.canvas.width/2,100);for(const t of this.buttons)e.fillStyle="rgba(0,0,0,0.2)",e.beginPath(),e.roundRect?e.roundRect(t.x+10,t.y+10,t.width,t.height,20):e.rect(t.x+10,t.y+10,t.width,t.height),e.fill(),e.fillStyle=t.color,e.beginPath(),e.roundRect?e.roundRect(t.x,t.y,t.width,t.height,20):e.rect(t.x,t.y,t.width,t.height),e.fill(),e.fillStyle="rgba(255,255,255,0.3)",e.beginPath(),e.roundRect?e.roundRect(t.x+10,t.y+10,t.width-20,t.height-80,15):e.rect(t.x+10,t.y+10,t.width-20,t.height-80),e.fill(),e.fillStyle="rgba(255,255,255,0.8)",e.beginPath(),e.arc(t.x+t.width/2,t.y+100,60,0,Math.PI*2),e.fill(),e.fillStyle="white",e.font='bold 36px "Nunito"',e.fillText(t.text,t.x+t.width/2,t.y+t.height-30)}onResize(e,i){this.createUI()}cleanup(){this.sceneManager.getCanvas().removeEventListener("pointerup",this.handleInput)}}document.addEventListener("DOMContentLoaded",()=>{const c=document.getElementById("gameCanvas");console.log("GAME VERSION: Mobile Fix 2.0 (Loaded)"),w.getInstance().load();const e=new C(c);e.switchScene(new y(e))});
